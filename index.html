<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pop-Up Panic!</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            padding: 60px 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            text-align: center;
            max-width: 500px;
            width: 100%;
            position: relative;
            z-index: 1;
        }

        h1 {
            font-size: 3em;
            color: #333;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .tagline {
            font-size: 1.1em;
            color: #666;
            font-style: italic;
            margin-bottom: 50px;
            line-height: 1.6;
        }

        .points-section {
            background: #f0f0f0;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 40px;
        }

        .points-label {
            font-size: 1.2em;
            color: #666;
            margin-bottom: 10px;
        }

        .points-tally {
            font-size: 3em;
            font-weight: bold;
            color: #667eea;
        }

        .start-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 50px;
            font-size: 1.3em;
            border-radius: 50px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .start-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.6);
        }

        .start-button:active {
            transform: translateY(0);
        }

        /* Pop-up Ad Styles */
        .popup-ad {
            position: fixed;
            background: white;
            border: 2px solid #333;
            border-radius: 8px;
            padding: 40px 30px 30px 30px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            z-index: 100;
        }

        .popup-ad-close-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #ff6b6b;
            color: white;
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            font-size: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s;
        }

        .popup-ad-close-btn:hover {
            background: #ff5252;
        }

        .popup-ad-content {
            text-align: center;
            color: #333;
            line-height: 1.6;
        }

        .popup-ad-content h2 {
            margin-bottom: 20px;
            font-size: 2em;
            font-weight: bold;
        }

        .popup-ad-content p {
            margin-bottom: 12px;
            font-size: 1em;
        }

        .game-area {
            display: none;
        }

        .game-area.active {
            display: block;
        }

        .start-screen {
            display: block;
        }

        .start-screen.hidden {
            display: none;
        }

        .game-over-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .game-over-screen.active {
            display: flex;
        }

        .game-over-content {
            background: white;
            padding: 60px 40px;
            border-radius: 20px;
            text-align: center;
            max-width: 500px;
        }

        .game-over-content h1 {
            font-size: 3em;
            color: #ff6b6b;
            margin-bottom: 20px;
        }

        .game-over-content p {
            font-size: 1.2em;
            color: #333;
            margin-bottom: 15px;
        }

        .final-score {
            font-size: 2.5em;
            font-weight: bold;
            color: #667eea;
            margin: 30px 0;
        }

        .restart-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 50px;
            font-size: 1.3em;
            border-radius: 50px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .restart-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.6);
        }

        .era-popup.virus-popup {
            background: #ff6b6b !important;
            border-color: #cc0000 !important;
        }

        .era-popup.virus-popup .popup-ad-content {
            color: white !important;
        }

        .virus-warning {
            font-size: 1.5em;
            margin-bottom: 10px;
        }

        @keyframes popupSlideIn {
            from {
                opacity: 0;
                transform: scale(0.8);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        @keyframes popupFadeOut {
            from {
                opacity: 1;
                transform: scale(1);
            }
            to {
                opacity: 0;
                transform: scale(0.8);
            }
        }

        .popup-ad {
            animation: popupSlideIn 0.3s ease-out;
        }

        .popup-hint {
            animation: hintFadeIn 0.5s ease-in 10s forwards;
            opacity: 0;
        }

        @keyframes hintFadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        /* Era-specific styling */
        
        /* Early Web (1990s) - Gray, basic HTML, under construction vibes */
        .era-popup.earlyWeb {
            border: 3px solid #000080;
            border-radius: 0 !important;
            box-shadow: 3px 3px 0px #000000;
            background: repeating-linear-gradient(
                0deg,
                #e0e0e0,
                #e0e0e0 2px,
                #d0d0d0 2px,
                #d0d0d0 4px
            ) !important;
        }
        .era-popup.earlyWeb .popup-ad-close-btn {
            background: #000080;
            border-radius: 0;
            font-family: "Times New Roman", serif;
        }
        .era-popup.earlyWeb .popup-ad-content {
            border: 2px inset #808080;
            padding: 15px;
            margin-top: 10px;
        }

        /* MySpace/AIM (2003-2008) - Neon chaos, glitter, dark background */
        @keyframes glitter {
            0%, 100% { text-shadow: 0 0 5px #ff00ff, 0 0 10px #ff00ff, 0 0 15px #ff00ff; }
            25% { text-shadow: 0 0 5px #00ffff, 0 0 10px #00ffff, 0 0 20px #00ffff; }
            50% { text-shadow: 0 0 5px #ff00ff, 0 0 10px #00ff00, 0 0 15px #ff00ff; }
            75% { text-shadow: 0 0 5px #ffff00, 0 0 10px #ffff00, 0 0 20px #ffff00; }
        }
        @keyframes sparkle {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .era-popup.myspace {
            border: 5px dashed #ff00ff !important;
            transform: rotate(-2deg);
            box-shadow: 
                5px 5px 0px #ff00ff, 
                10px 10px 0px #00ffff,
                15px 15px 0px #ff6600;
            background: linear-gradient(180deg, #1a0a2e 0%, #0d001a 50%, #1a0a2e 100%) !important;
        }
        .era-popup.myspace .popup-ad-content {
            animation: glitter 2s infinite;
            color: #00ff00 !important;
        }
        .era-popup.myspace .popup-ad-content::before {
            content: 'âœ¨';
            animation: sparkle 0.5s infinite;
        }
        .era-popup.myspace .popup-ad-content::after {
            content: 'âœ¨';
            animation: sparkle 0.5s infinite 0.25s;
        }
        .era-popup.myspace .popup-ad-close-btn {
            background: #ff00ff;
            border: 2px solid #00ffff;
            animation: sparkle 0.8s infinite;
        }

        /* AOL/Dial-up - Classic Windows dialog, gray, beveled */
        .era-popup.aol {
            border: none !important;
            border-radius: 0 !important;
            box-shadow: 
                inset -1px -1px #0a0a0a,
                inset 1px 1px #ffffff,
                inset -2px -2px #808080,
                inset 2px 2px #dfdfdf;
            background: #c0c0c0 !important;
        }
        .era-popup.aol::before {
            content: 'ğŸ“¬ AOL';
            display: block;
            background: linear-gradient(90deg, #000080, #1084d0);
            color: white;
            font-weight: bold;
            padding: 3px 5px;
            margin: -40px -30px 15px -30px;
            font-family: MS Sans Serif, Arial, sans-serif;
            font-size: 12px;
        }
        .era-popup.aol .popup-ad-close-btn {
            background: #c0c0c0;
            color: #000;
            border: 2px outset #dfdfdf;
            border-radius: 0;
            font-size: 16px;
            font-weight: bold;
            width: 18px;
            height: 18px;
        }
        .era-popup.aol .popup-ad-close-btn:hover {
            background: #a0a0a0;
        }

        /* Windows 95/98 - Authentic Win95 dialog with title bar */
        .era-popup.win95 {
            border: none !important;
            border-radius: 0 !important;
            padding-top: 25px !important;
            box-shadow: 
                inset -1px -1px #0a0a0a,
                inset 1px 1px #ffffff,
                inset -2px -2px #808080,
                inset 2px 2px #dfdfdf,
                2px 2px 0px #000000;
            background: #c0c0c0 !important;
        }
        .era-popup.win95::before {
            content: 'âš ï¸ Windows';
            display: block;
            background: linear-gradient(90deg, #000080, #1084d0);
            color: white;
            font-weight: bold;
            padding: 2px 4px;
            margin: -25px -30px 10px -30px;
            font-family: MS Sans Serif, Tahoma, sans-serif;
            font-size: 11px;
            letter-spacing: 0.5px;
        }
        .era-popup.win95 .popup-ad-close-btn {
            background: #c0c0c0;
            color: #000;
            border: 2px outset #ffffff;
            border-color: #ffffff #808080 #808080 #ffffff;
            border-radius: 0;
            font-family: "Marlett", sans-serif;
            font-size: 12px;
            font-weight: bold;
            width: 16px;
            height: 14px;
            top: 3px !important;
            right: 4px !important;
            padding: 0;
            line-height: 10px;
        }
        .era-popup.win95 .popup-ad-close-btn:hover {
            border-color: #ffffff #808080 #808080 #ffffff;
        }
        .era-popup.win95 .popup-ad-close-btn:active {
            border-color: #808080 #ffffff #ffffff #808080;
        }
        .era-popup.win95 .popup-ad-content {
            border: 1px solid #808080;
            border-color: #808080 #ffffff #ffffff #808080;
            background: #ffffff;
            padding: 20px;
            margin: 10px 0;
        }

        /* Web 2.0 (2010-2020) - Clean, minimal, gradients, shadows */
        .era-popup.web20 {
            border: none !important;
            border-radius: 16px !important;
            box-shadow: 
                0 10px 40px rgba(0, 0, 0, 0.12),
                0 0 0 1px rgba(0, 0, 0, 0.05);
            background: linear-gradient(180deg, #ffffff 0%, #f8f8f8 100%) !important;
        }
        .era-popup.web20 .popup-ad-close-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 50%;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.4);
        }
        .era-popup.web20 .popup-ad-content {
            color: #333 !important;
            font-weight: 300;
            letter-spacing: 0.3px;
        }

        /* Gen-Z (2020+) - Soft aesthetic, pastel accents, italic */
        @keyframes gradientShift {
            0% { border-color: #a855f7; }
            25% { border-color: #06b6d4; }
            50% { border-color: #10b981; }
            75% { border-color: #f59e0b; }
            100% { border-color: #a855f7; }
        }
        .era-popup.genz {
            border: 3px solid #a855f7 !important;
            border-radius: 20px !important;
            animation: gradientShift 4s infinite;
            box-shadow: 
                0 8px 32px rgba(168, 85, 247, 0.15),
                inset 0 0 20px rgba(255, 255, 255, 0.5);
            background: linear-gradient(135deg, #fefefe 0%, #fdf4ff 50%, #f0fdfa 100%) !important;
        }
        .era-popup.genz .popup-ad-close-btn {
            background: linear-gradient(135deg, #a855f7, #06b6d4);
            border-radius: 50%;
        }
        .era-popup.genz .popup-ad-content {
            font-style: italic;
            color: #1a1a1a !important;
        }

        /* AI Era (2024+) - Terminal, dark, cyan glow, scanlines */
        @keyframes scanline {
            0% { background-position: 0 0; }
            100% { background-position: 0 100%; }
        }
        @keyframes cursorBlink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        @keyframes glowPulse {
            0%, 100% { box-shadow: 0 0 20px rgba(0, 217, 255, 0.3), inset 0 0 10px rgba(0, 217, 255, 0.1); }
            50% { box-shadow: 0 0 40px rgba(0, 217, 255, 0.5), inset 0 0 20px rgba(0, 217, 255, 0.2); }
        }
        .era-popup.ai {
            border: 2px solid #00d9ff !important;
            border-radius: 4px !important;
            animation: glowPulse 2s infinite;
            background: 
                repeating-linear-gradient(
                    0deg,
                    rgba(0, 0, 0, 0) 0px,
                    rgba(0, 0, 0, 0) 2px,
                    rgba(0, 217, 255, 0.03) 2px,
                    rgba(0, 217, 255, 0.03) 4px
                ),
                #0a0e27 !important;
        }
        .era-popup.ai::before {
            content: '> SYSTEM_PROMPT.exe';
            display: block;
            color: #00ff00;
            font-family: "Courier New", monospace;
            font-size: 10px;
            margin-bottom: 10px;
            padding-bottom: 5px;
            border-bottom: 1px solid #00d9ff;
        }
        .era-popup.ai .popup-ad-close-btn {
            background: transparent;
            border: 1px solid #00d9ff;
            color: #00d9ff;
            border-radius: 0;
            font-family: "Courier New", monospace;
        }
        .era-popup.ai .popup-ad-close-btn:hover {
            background: #00d9ff;
            color: #0a0e27;
        }
        .era-popup.ai .popup-ad-content {
            color: #00d9ff !important;
            font-family: "Courier New", monospace;
        }
        .era-popup.ai .popup-ad-content::after {
            content: '_';
            animation: cursorBlink 1s infinite;
        }

        /* Flash Era (2000-2017) - Black with orange accents, loading bars */
        @keyframes flashPulse {
            0%, 100% { box-shadow: 0 0 10px #ff6600, inset 0 0 5px rgba(255, 102, 0, 0.2); }
            50% { box-shadow: 0 0 20px #ff6600, inset 0 0 10px rgba(255, 102, 0, 0.4); }
        }
        .era-popup.flash {
            border: 3px solid #ff6600 !important;
            border-radius: 0 !important;
            animation: flashPulse 1.5s infinite;
            background: linear-gradient(180deg, #1a1a1a 0%, #000000 100%) !important;
        }
        .era-popup.flash::before {
            content: 'â–¶ Adobe Flash Player';
            display: block;
            color: #ff6600;
            font-family: Impact, sans-serif;
            font-size: 11px;
            margin-bottom: 8px;
            text-transform: uppercase;
        }
        .era-popup.flash .popup-ad-close-btn {
            background: #ff6600;
            border-radius: 0;
        }
        .era-popup.flash .popup-ad-content {
            color: #ffffff !important;
        }

        /* Mobile Era (2012+) - Clean iOS/Android style */
        .era-popup.mobile {
            border: none !important;
            border-radius: 14px !important;
            box-shadow: 
                0 10px 30px rgba(0, 0, 0, 0.15),
                0 0 0 0.5px rgba(0, 0, 0, 0.1);
            background: #f5f5f7 !important;
        }
        .era-popup.mobile::before {
            content: 'ğŸ“±';
            display: block;
            font-size: 24px;
            margin-bottom: 5px;
        }
        .era-popup.mobile .popup-ad-close-btn {
            background: #007aff;
            border-radius: 50%;
        }
        .era-popup.mobile .popup-ad-content {
            color: #1d1d1f !important;
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro", sans-serif;
        }

        /* Trap button styles */
        .trap-button {
            display: inline-block;
            margin: 8px 5px;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.1s, box-shadow 0.1s, outline 0.1s;
        }
        .trap-button:hover {
            transform: scale(1.05);
        }
        .trap-button:focus {
            outline: 3px solid #ffcc00;
            outline-offset: 2px;
        }
        .trap-button.primary {
            background: linear-gradient(180deg, #4a90d9 0%, #357abd 100%);
            color: white;
            box-shadow: 0 2px 4px rgba(53, 122, 189, 0.4);
        }
        .trap-button.danger {
            background: linear-gradient(180deg, #ff6b6b 0%, #ee5a5a 100%);
            color: white;
            box-shadow: 0 2px 4px rgba(238, 90, 90, 0.4);
        }
        .trap-button.success {
            background: linear-gradient(180deg, #51cf66 0%, #40c057 100%);
            color: white;
            box-shadow: 0 2px 4px rgba(64, 192, 87, 0.4);
        }
        .trap-button.secondary {
            background: linear-gradient(180deg, #868e96 0%, #6c757d 100%);
            color: white;
            box-shadow: 0 2px 4px rgba(108, 117, 125, 0.4);
        }
        .tab-button {
            display: inline-block;
            margin: 8px 5px;
            padding: 12px 24px;
            border: 2px solid #666;
            border-radius: 6px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.15s;
            background: #f0f0f0;
            color: #333;
        }
        .tab-button:focus {
            outline: none;
            border-color: #4a90d9;
            background: #e3f2fd;
            box-shadow: 0 0 0 4px rgba(74, 144, 217, 0.3);
            transform: scale(1.05);
        }
        .tab-button.correct:focus {
            border-color: #40c057;
            background: #d3f9d8;
            box-shadow: 0 0 0 4px rgba(64, 192, 87, 0.3);
        }
        .tab-button.wrong:focus {
            border-color: #ff6b6b;
            background: #ffe3e3;
            box-shadow: 0 0 0 4px rgba(255, 107, 107, 0.3);
        }

        /* Alternative safe-close interaction styles */
        .safe-link {
            display: block;
            margin-top: 12px;
            font-size: 11px;
            color: #888;
            text-decoration: underline;
            cursor: pointer;
            text-align: center;
            transition: color 0.2s;
        }
        .safe-link:hover {
            color: #555;
        }
        .safe-small-text {
            display: block;
            margin-top: 14px;
            font-size: 10px;
            color: #aaa;
            cursor: pointer;
            text-align: center;
            font-style: italic;
        }
        .safe-small-text:hover {
            color: #666;
            text-decoration: underline;
        }
        .safe-skip-arrow {
            display: block;
            margin-top: 10px;
            font-size: 11px;
            color: #999;
            cursor: pointer;
            text-align: right;
            padding-right: 10px;
        }
        .safe-skip-arrow:hover {
            color: #555;
        }

        @keyframes gameOverSlideIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        .game-over-screen {
            animation: gameOverSlideIn 0.5s ease-out;
        }
    </style>
</head>
<body>
    <div class="container start-screen" id="startScreen">
        <h1>Pop-Up Panic!</h1>
        <p class="tagline">From AOL to the AI age... the only constants of the internet are the ads.</p>
        
        <div class="points-section">
            <div class="points-label">Points</div>
            <div class="points-tally" id="pointsDisplay">0</div>
        </div>

        <button class="start-button" id="startButton">Start Game</button>
    </div>

    <div class="game-area" id="gameArea">
        <div class="container">
            <h1>Pop-Up Panic!</h1>
            <div class="points-section">
                <div class="points-label">Points</div>
                <div class="points-tally" id="pointsGameDisplay">0</div>
            </div>
        </div>
    </div>

    <div class="game-over-screen" id="gameOverScreen">
        <div class="game-over-content">
            <h1>GAME OVER</h1>
            <p>You clicked on a virus!</p>
            <div class="final-score" id="finalScore">0</div>
            <p>Points Earned</p>
            <button class="restart-button" id="restartButton">Play Again</button>
        </div>
    </div>

    <script>
        // ERA DEFINITIONS - Phase 1: Architecture & Era Definitions
        const ERAS = {
            earlyWeb: {
                name: 'Early Web',
                period: '1990s',
                bgColor: '#e0e0e0',
                textColor: '#000080',
                borderColor: '#000000',
                fontFamily: '"Times New Roman", serif',
                fontSize: '14px',
                examples: [
                    { text: 'ğŸš§ UNDER CONSTRUCTION ğŸš§<br><small>Sign up to be notified!</small>', trapButtons: ['Notify Me! ğŸ””'], safeButtons: ['Already Know'] },
                    { text: 'You are visitor #' + Math.floor(Math.random() * 999999) + '!<br>ğŸ‰ YOU\'VE WON A FREE GIFT! ğŸ‰', trapButtons: ['CLAIM FREE GIFT!'], safeButtons: ['I Doubt It'] },
                    { text: 'â­ VOTE: COOL SITE OF THE DAY â­<br>Only 2 votes away from #1!', trapButtons: ['Cast My Vote!'], safeButtons: ['Not Worthy'] },
                    { text: 'ğŸ“¥ Download 47 FREE Screensavers!<br>Flying Toasters + Bonus Pack Inside!', trapButtons: ['GET FREE PACK!'], safeButtons: ['I Have Enough'] },
                    { text: 'âœï¸ Be the first to sign my Guestbook!<br>I\'ll add YOU to my Top Links!', trapButtons: ['Sign It! âœï¸'], safeButtons: ['Just Browsing'] },
                    { text: 'ğŸ”— Join our WEBRING & get 1000 visitors!<br>[â† Prev] [Random] [Next â†’]', trapButtons: ['Join & Get Traffic!'], safeButtons: ['Exit Ring'] },
                    { text: 'ğŸ“§ webmaster@geocities.com<br>ğŸ’Œ Email me for FREE link exchange!', trapButtons: ['Let\'s Trade Links!'], safeButtons: ['No Thanks'] },
                    { text: 'ğŸ†• JUST UPDATED: ' + new Date().toLocaleDateString() + '<br>New secret page revealed!', trapButtons: ['Show Secret Page!'], safeButtons: ['Old News'] },
                    { text: 'ğŸ’¾ Best viewed in Netscape Navigator 4.0<br>ğŸ Download it FREE right now!', trapButtons: ['Get Netscape FREE'], safeButtons: ['I Use IE'] },
                    { text: 'ğŸµ EPIC MIDI COLLECTION ğŸµ<br>500+ songs, all FREE to download!', trapButtons: ['GET ALL 500!'], safeButtons: ['My Ears Hurt'] },
                    { text: 'ğŸ‘ï¸ This page has been viewed<br>by CELEBRITIES! Click to see who!', trapButtons: ['See The List!'], safeButtons: ['That\'s A Stretch'] },
                    { text: 'ğŸ–±ï¸ CLICK HERE â€” You won\'t believe<br>what our webmaster discovered!', trapButtons: ['I MUST KNOW!!!'], safeButtons: ['I Believe Nothing'] }
                ],
                virusMessages: [
                    'ğŸ° CONGRATULATIONS!!!<br>You are visitor #1,000,000!<br>CLAIM YOUR FREE LAPTOP NOW!',
                    'âš ï¸ CRITICAL: YOUR COMPUTER HAS A VIRUS!<br>Download FixMyPC.exe to clean NOW!',
                    'ğŸ’° You WON $10,000!!!<br>Enter your details to claim immediately!',
                    'ğŸ”¥ HOT SINGLES in your area!<br>They\'re waiting â€” click NOW!'
                ]
            },
            myspaceAim: {
                name: 'MySpace/AIM',
                period: '2003-2008',
                bgColor: '#1a0a2e',
                textColor: '#00ff00',
                borderColor: '#ff00ff',
                fontFamily: '"Comic Sans MS", cursive',
                fontSize: '16px',
                examples: [
                    { text: 'âœ¨ Tom wants 2 b ur friend! âœ¨<br>~*~He ONLY added u!*~*~', trapButtons: ['~*~ACCEPT TOM~*~'], safeButtons: ['Deny Tom ğŸ’”'] },
                    { text: 'ğŸ’¥ OMG U HAVE BEEN POKED ğŸ’¥<br>by xXx_DaRkAnGeL_xXx pOkE bAcK?!', trapButtons: ['pOkE bAcK INSTANTLY!!!'], safeButtons: ['ignore poke'] },
                    { text: '~*~AIM~*~ xXx_DaRkAnGeL_xXx<br>sent u a SUPER SECRET message...', trapButtons: ['omg reply now...'], safeButtons: ['go away'] },
                    { text: 'â™ª NOW PLAYING: Helena (MCR) â™ª<br>Add 2 ur profile 4 FREE! ğŸ¸ğŸ–¤', trapButtons: ['add 2 my profile!! ğŸ–¤'], safeButtons: ['change song'] },
                    { text: '<<< RaTe My PrOfILe!!! >>><br>*~*I rated urs a 10!!*~*', trapButtons: ['omg rate me back!!!'], safeButtons: ['lol no'] },
                    { text: 'Â¸.â€¢Â´`â€¢.Â¸ TOP 8 UPDATE Â¸.â€¢Â´`â€¢.Â¸<br>u just moved to #1 on someone\'s list!', trapButtons: ['omg who?! tell me!!!'], safeButtons: ['im out'] },
                    { text: 'PC4PC??? ğŸ“¸<br>I already commented urs â€” ur turn!!!', trapButtons: ['comment me NOW!!!'], safeButtons: ['no thx'] },
                    { text: '~*~BFF 4EVER~*~<br>ur BFF added u 2 their TOP 8!!! ğŸ’•', trapButtons: ['bff 4ever!! ğŸ’•'], safeButtons: ['we r done'] },
                    { text: 'a/s/l??? ğŸ¤”<br>im 14/f/cali wanna chat??', trapButtons: ['lol same lets chat'], safeButtons: ['creepy...'] },
                    { text: 'ğŸ’” emo hours ğŸ’”<br>someone made u a glitter graphic ğŸ–¤', trapButtons: ['show me the graphic ğŸ–¤'], safeButtons: ['cheer up'] },
                    { text: 'ğŸŒŸ GLITTER TEXT GENERATOR ğŸŒŸ<br>Make ur name sparkle 4 FREE!!!', trapButtons: ['make my name sparkle!!!'], safeButtons: ['too much'] },
                    { text: 'ğŸ“± NEW AWAY MSG from ur crush ğŸ“±<br>"thinking about u... ğŸ˜"', trapButtons: ['reply instantly!!!'], safeButtons: ['stay away plz'] }
                ],
                virusMessages: [
                    'ğŸ’• Someone has a SECRET CRUSH on u!!! ğŸ’•<br>Click 2 find out WHO! They added u ğŸ‘€',
                    'ğŸ FREE iPhone 15 Pro!!! ğŸ<br>Just complete 1 quick survey (30 sec)!',
                    'âš¡ 847 people viewed ur profile TODAY!<br>Add this code 2 see ALL their names!',
                    'ğŸ”¥ EPIC NEW PROFILE LAYOUT ğŸ”¥<br>Auto-glitter! Auto-plays MCR! Click NOW!'
                ]
            },
            aolDialup: {
                name: 'AOL/Dial-up',
                period: '1995-2005',
                bgColor: '#c0c0c0',
                textColor: '#000000',
                borderColor: '#808080',
                fontFamily: 'MS Sans Serif, Arial, sans-serif',
                fontSize: '14px',
                examples: [
                    { text: 'ğŸ“¬ You\'ve Got Mail! (3 unread)<br>One appears to be from a publisher!', trapButtons: ['Read Now! ğŸ“¬'], safeButtons: ['Mark as Spam'] },
                    { text: 'ğŸ”Œ Dial-up connected!<br>Download TODAY\'S top 10 files FREE', trapButtons: ['See Top 10 FREE!'], safeButtons: ['Hang Up'] },
                    { text: 'ğŸ’¿ FREE AOL Trial CD â€” 1000 Hours!<br>BONUS: Free email address for life!', trapButtons: ['Get FREE 1000 Hours!'], safeButtons: ['I Have 47 CDs'] },
                    { text: 'ğŸ‘¤ Buddy List Update!<br>SoccerMom42 is ONLINE and waiting!', trapButtons: ['IM Her Now! ğŸ’¬'] },
                    { text: 'ğŸ”‘ Keyword: FREESTUFF<br>47 FREE downloads waiting for you!', trapButtons: ['Get My FREE Stuff!'], safeButtons: ['Nah'] },
                    { text: 'â³ Download 47% complete!<br>Stay connected â€” upgrade to DSL!', trapButtons: ['Upgrade to DSL â†’'], safeButtons: ['Cancel Download'] },
                    { text: 'ğŸ“ MOM, HANG UP! I\'m online!<br>Never lose connection â€” Get DSL!', trapButtons: ['Upgrade to DSL NOW'], safeButtons: ['Fine Mom'] },
                    { text: 'ğŸ’¬ New IM from HotStuff1999<br>"hey cutie, a/s/l?" ğŸ‘€', trapButtons: ['Reply! ğŸ’¬'], safeButtons: ['Block'] },
                    { text: 'ğŸŒ Welcome, Member #4,721,847!<br>You have exclusive perks waiting!', trapButtons: ['See My Perks!'], safeButtons: ['Logout'] },
                    { text: 'âš ï¸ Connection Dropped!<br>Someone picked up the phone AGAIN!<br>Get DSL: never lose connection!', trapButtons: ['Never Lose Connection!'], safeButtons: ['Reconnect'] },
                    { text: 'ğŸµ You\'ve Got Mail!<br>Open it before your session times out!', trapButtons: ['Open Before Timeout!'], safeButtons: ['Mute'] },
                    { text: 'ğŸ“‹ Chat Room: Lobby 1<br>23 members â€¢ 1 is messaging YOU!', trapButtons: ['See Who! ğŸ‘€'], safeButtons: ['Exit'] },
                    { text: 'â˜ï¸ INCOMING CALL DETECTED!<br>Protect your download â€” upgrade DSL!', trapButtons: ['Protect My Downloads!'], safeButtons: ['Risk It'] },
                    { text: 'ğŸŒ Your connection: 28.8kbps<br>Your neighbor\'s: 1.5Mbps DSL ğŸ˜¢', trapButtons: ['Go Faster NOW!'], safeButtons: ['This Is Fine'] }
                ],
                virusMessages: [
                    'ğŸ† AOL MEMBER REWARD!<br>You\'ve won a FREE Laptop + $500 Gift Card!<br>Click to claim before it expires!',
                    'âš ï¸ URGENT: Account Suspended!<br>Click here to verify your identity NOW!',
                    'ğŸ’° Make $3,000+/week from home!<br>Mom discovered this one weird trick!',
                    'ğŸ”’ SECURITY BREACH DETECTED!<br>Update your password IMMEDIATELY!'
                ]
            },
            windows95: {
                name: '90s Windows',
                period: '1995-2005',
                bgColor: '#c0c0c0',
                textColor: '#000000',
                borderColor: '#808080',
                fontFamily: 'MS Sans Serif, Arial, sans-serif',
                fontSize: '13px',
                examples: [
                    { text: 'âš ï¸ CRITICAL UPDATE AVAILABLE<br>Security patch required immediately!', trapButtons: ['Protect My PC Now!'], safeButtons: ['Risk It Later'] },
                    { text: 'ğŸ’¾ Unsaved changes detected!<br>Save now to avoid losing your work?', trapButtons: ['Save Now!'], safeButtons: ['Lose It All'] },
                    { text: 'ğŸ–¨ï¸ Printer driver outdated!<br>Download the latest for FREE', trapButtons: ['Get FREE Driver'], safeButtons: ['Cancel'] },
                    { text: 'ğŸ“ New folder created on Desktop<br>Open and see what\'s inside?', trapButtons: ['Open Folder ğŸ“‚'], safeButtons: ['OK'] },
                    { text: 'ğŸ”„ System optimization needed!<br>Speed up your PC for FREE', trapButtons: ['Speed Up FREE!'], safeButtons: ['Stay Slow'] },
                    { text: 'ğŸ’¿ Disk 2 of 47 ready!<br>Click OK to continue installation', trapButtons: ['Continue Install'], safeButtons: ['Cancel Setup'] },
                    { text: 'â³ Internet Explorer Not Responding<br>Recover lost session now?', trapButtons: ['Recover Session!'], safeButtons: ['End Task'] },
                    { text: 'ğŸ–¥ï¸ Your display is set too low!<br>Fix your resolution for best results', trapButtons: ['Fix It Now!'], safeButtons: ['Looks Fine'] },
                    { text: 'ğŸ”Š New audio device detected!<br>Install driver for SURROUND SOUND', trapButtons: ['Install Surround!'], safeButtons: ['Cancel'] },
                    { text: 'ğŸ“‹ Your clipboard has 47 items!<br>Sync to the cloud for FREE', trapButtons: ['Sync FREE! â˜ï¸'], safeButtons: ['Clear'] },
                    { text: 'ğŸ—‘ï¸ Recycle Bin is full!<br>Clean & free up space in 1 click', trapButtons: ['Clean 1-Click!'], safeButtons: ['Leave It'] },
                    { text: 'âš¡ WARNING: Only 200MB left on C:<br>Get 10GB storage FREE today!', trapButtons: ['Get 10GB FREE!'], safeButtons: ['Run Low'] }
                ],
                virusMessages: [
                    'â˜ ï¸ VIRUS DETECTED: 47 THREATS!!!<br>Your PC is critically infected!<br>[CLEAN NOW â€” IT\'S FREE!]',
                    'âš ï¸ CRITICAL SYSTEM FAILURE!<br>Data loss imminent in 60 seconds!<br>[FIX IMMEDIATELY]',
                    'ğŸ”§ Your PC is running at 3% speed!<br>FREE optimizer downloaded â€” install now!',
                    'ğŸ’€ HARD DRIVE CORRUPTED!<br>Recover your files â€” click to start FREE!'
                ]
            },
            flash: {
                name: 'Flash Era',
                period: '2000-2017',
                bgColor: '#000000',
                textColor: '#ffffff',
                borderColor: '#ff6600',
                fontFamily: 'Impact, sans-serif',
                fontSize: '14px',
                examples: [
                    { text: 'â–¶ï¸ LOADING...<br>â–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘ 34% â€” Almost there!', trapButtons: ['Keep Waiting...'], safeButtons: ['Refresh'] },
                    { text: 'ğŸ® PLAY 47 FREE GAMES!<br>No download â€” starts instantly!', trapButtons: ['PLAY FREE NOW!'], safeButtons: ['Later'] },
                    { text: 'ğŸ¬ Skip Ad in 5... 4... 3...<br>* Terms: 30 second minimum applies', trapButtons: ['Skip Ad â†’'], safeButtons: ['Watch Full Ad'] },
                    { text: 'ğŸ”Š TURN SOUND ON! ğŸ”Š<br>You\'re missing the best part!', trapButtons: ['ğŸ”Š ENABLE SOUND!'], safeButtons: ['Mute All'] },
                    { text: 'âš ï¸ Your Flash Player is OUT OF DATE!<br>Update now to continue playing!', trapButtons: ['Update Flash FREE!'], safeButtons: ['Not Today'] },
                    { text: 'ğŸ† YOU JUST BEAT THE HIGH SCORE!<br>Submit your name to the leaderboard?', trapButtons: ['Submit My Score! ğŸ†'], safeButtons: ['Stay Anonymous'] },
                    { text: 'â­ Rate this game & unlock BONUS LEVEL!<br>Just 5 stars to unlock hidden content!', trapButtons: ['5 Stars + Unlock! â­'], safeButtons: ['No Bonus Needed'] },
                    { text: 'ğŸ“º Buffering... 99%<br>Download the player for instant HD!', trapButtons: ['Get HD Player FREE!'], safeButtons: ['Wait Forever'] },
                    { text: 'ğŸª EXCLUSIVE ANIMATION<br>Join the club to see the full version!', trapButtons: ['Join Club FREE!'], safeButtons: ['Miss the Ending'] },
                    { text: 'ğŸ’¥ EPIC WIN! You got 3 stars!<br>Share your score + unlock bonus maps!', trapButtons: ['SHARE & UNLOCK! ğŸ—ºï¸'], safeButtons: ['Keep It Secret'] },
                    { text: 'ğŸ± Nyan Cat FULL EXTENDED VERSION ğŸŒˆ<br>10 hours â€” Download for FREE!', trapButtons: ['DOWNLOAD 10 HRS! ğŸŒˆ'], safeButtons: ['Stop Cat'] },
                    { text: 'ğŸµ TURN UP THE VOLUME ğŸµ<br>This song will change your life (for real)', trapButtons: ['MAX VOLUME NOW!'], safeButtons: ['Mute All'] },
                    { text: 'ğŸ® EXTREME FLASH GAMING PASS<br>Unlock ALL 500 games for FREE today!', trapButtons: ['UNLOCK 500 GAMES!'], safeButtons: ['Too Extreme'] },
                    { text: 'ğŸ“¦ FunnyVideo.exe is ready!<br>100% safe â€” scanned & verified âœ…', trapButtons: ['Download Verified File!'], safeButtons: ['Seems Sus'] },
                    { text: 'ğŸ”¥ HOT SINGLES PLAYING<br>EXCITING games near you', trapButtons: ['I\'m Single'], safeButtons: ['Not Hot'] }
                ],
                virusMessages: [
                    'â¬‡ï¸ YOUR FLASH IS OUT OF DATE!<br>FlashPlayer_REAL_v32.exe is ready!<br>[INSTALL NOW â€” REQUIRED!]',
                    'ğŸ YOU WON AN iPHONE 15!!! ğŸ‰<br>Spin the wheel to confirm your prize!',
                    'ğŸ° JACKPOT! You hit $10,000!<br>You\'re our lucky winner â€” claim NOW!',
                    'âš¡ WARNING: Your Flash is CRITICALLY outdated!<br>Install update or lose access forever!'
                ]
            },
            web20: {
                name: 'Modern Web 2.0',
                period: '2010-2020',
                bgColor: '#ffffff',
                textColor: '#333333',
                borderColor: '#cccccc',
                fontFamily: '-apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif',
                fontSize: '15px',
                examples: [
                    { text: 'ğŸ”” Get real-time deal alerts!<br>Be first for flash sales â€” 84% join', trapButtons: ['Yes, Alert Me! ğŸ””'], safeButtons: ['Miss All Deals'] },
                    { text: 'ğŸª We use cookies to give you<br>personalized offers worth $47', trapButtons: ['Accept & Unlock Deals'], safeButtons: ['Reject All'] },
                    { text: 'ğŸ“± Switch to the app!<br>20% OFF your next order, app-only', trapButtons: ['Get App & Save 20%!'], safeButtons: ['Pay Full Price'] },
                    { text: 'â­ Quick question: how are we doing?<br>Takes 10 seconds, means the world ğŸ™', trapButtons: ['â­â­â­â­â­ Leave Review'], safeButtons: ['Maybe Later'] },
                    { text: 'ğŸ“§ Join 1.2M subscribers!<br>Get our exclusive FREE weekly digest', trapButtons: ['Subscribe FREE â†’'], safeButtons: ['Stay Uninformed'] },
                    { text: 'â° FLASH SALE: 50% OFF â€” 4 min left!<br>Use code NOWORNEVER at checkout', trapButtons: ['GRAB 50% OFF NOW!'], safeButtons: ['Let It Expire'] },
                    { text: 'ğŸ‘¥ 847 people are viewing this right now<br>Only 3 left in stock!', trapButtons: ['Reserve Mine Now!'], safeButtons: ['Let Someone Else'] },
                    { text: 'ğŸ“Š You are in the TOP 5%<br>of our power users this week!', trapButtons: ['See My Stats ğŸ“ˆ'], safeButtons: ['Not Interested'] },
                    { text: 'ğŸ¯ Chosen just for you!<br>Based on 47 data points we collected', trapButtons: ['Show My Picks!'], safeButtons: ['Stop Tracking'] },
                    { text: 'ğŸ’¬ You missed 1,200 comments!<br>The discussion is going viral ğŸ”¥', trapButtons: ['Join Discussion!'], safeButtons: ['Nope'] },
                    { text: 'ğŸ”— Your friend Sarah shared this!<br>See what she\'s excited about ğŸ‘€', trapButtons: ['See What Sarah Likes'], safeButtons: ['Ignore Sarah'] },
                    { text: 'ğŸ“ˆ This is trending NOW<br>8.4M views in 2 hours â€” see why!', trapButtons: ['Watch Viral Video!'], safeButtons: ['Overrated'] },
                    { text: 'ğŸ§‘â€ğŸ³ GORDON RAMSAY\'S<br>MASTERCLASS: "Finally,<br>some good f***ing ads"', trapButtons: ['Enroll Now'], safeButtons: ['It\'s RAW!'] },
                    { text: 'ğŸ³ Gordon says: "This ad<br>is so raw it\'s still<br>loading on dial-up!"', trapButtons: ['Cook It!'], safeButtons: ['Disgusting!'] },
                    { text: 'ğŸ“º STREAMING NOW:<br>10 hours of someone<br>saying "smash that like"', trapButtons: ['Smash Like'], safeButtons: ['Unsubscribe'] },
                    { text: 'ğŸ”” You have 1,847 unread<br>notifications. 1,846 are<br>from LinkedIn.', trapButtons: ['Open LinkedIn'], safeButtons: ['mark all read'] },
                    { text: 'ğŸ“Š Your data has been<br>sold to 47 companies<br>Here\'s a cookie banner!', trapButtons: ['Accept All'], safeButtons: ['pretend this helps'] },
                    { text: 'ğŸ’¼ Someone viewed<br>your LinkedIn profile!<br>jk it was a recruiter bot', trapButtons: ['Connect'], safeButtons: ['stay unemployed'] }
                ],
                virusMessages: [
                    'ğŸ”’ Your session has expired!<br>For your security, sign in again now<br>[SECURE SIGN IN]',
                    'âš ï¸ Unusual login detected!<br>Was this you? Verify your identity NOW!',
                    'ğŸ’° CONGRATULATIONS â€” You\'ve been selected!<br>Exclusive reward expires in 02:47!<br>[CLAIM MY REWARD]',
                    'ğŸ“¦ Delivery attempt failed!<br>Reschedule or your parcel will be returned!',
                    'ğŸ§‘â€ğŸ³ GORDON RAMSAY:<br>"Your password is<br>PATHETIC!" [CHANGE IT]'
                ]
            },
            mobile: {
                name: 'Mobile Era',
                period: '2012+',
                bgColor: '#f5f5f7',
                textColor: '#1d1d1f',
                borderColor: '#d2d2d7',
                fontFamily: '-apple-system, BlinkMacSystemFont, "SF Pro", sans-serif',
                fontSize: '15px',
                examples: [
                    { text: 'ğŸ You have a reward waiting!<br>Open the app to claim your prize ğŸ†', trapButtons: ['Claim Reward! ğŸ'], safeButtons: ['Not Interested'] },
                    { text: 'â­ Enjoying the app? Quick review?<br>Takes 10 sec â€” helps us grow!', trapButtons: ['Rate 5 Stars â­â­â­â­â­'], safeButtons: ['Not Now'] },
                    { text: 'ğŸ”‹ Enable Background Refresh?<br>Get weather, scores & news instantly!', trapButtons: ['Enable for Best Experience'], safeButtons: ['Deny'] },
                    { text: 'ğŸ“ Allow location?<br>Unlock nearby deals up to 70% OFF!', trapButtons: ['Yes! Show Deals Near Me!'], safeButtons: ['No Deals For Me'] },
                    { text: 'ğŸ”” Be the first to know!<br>Allow notifications for exclusive drops', trapButtons: ['Allow Notifications ğŸ””'], safeButtons: ['Miss Out'] },
                    { text: 'â˜ï¸ Back up to iCloud now!<br>Your precious photos are unprotected', trapButtons: ['Protect My Photos! â˜ï¸'], safeButtons: ['Risk Losing Them'] },
                    { text: 'ğŸ“¸ Allow camera for AR features?<br>Try on products before you buy!', trapButtons: ['Try It On! ğŸ“¸'], safeButtons: ['No Thanks'] },
                    { text: 'ğŸ’¾ Low storage alert!<br>Free up 4.7GB with one tap', trapButtons: ['Free Up Space! âœ¨'], safeButtons: ['Keep Junk'] },
                    { text: 'ğŸ® Your friends are playing now!<br>Get 200 FREE coins to catch up!', trapButtons: ['Grab 200 FREE Coins! ğŸ’'], safeButtons: ['Stay Behind'] },
                    { text: 'ğŸ“º Watch just 1 ad (30 sec)<br>Earn 50 bonus coins + unlock level!', trapButtons: ['Watch & Earn! ğŸ†'], safeButtons: ['Skip'] },
                    { text: 'ğŸ†“ Premium FREE for 7 days!<br>No ads, all features â€” cancel anytime<br>(we dare you to find the button)', trapButtons: ['Start My Free Trial! âœ¨'], safeButtons: ['Stay Limited'] },
                    { text: 'ğŸ‘† Swipe up for VIP access!<br>Only 12 exclusive spots remaining!', trapButtons: ['Secure My VIP Spot!'], safeButtons: ['Miss Out'] },
                    { text: 'ğŸ° Spin the wheel!<br>Win up to $0.03<br>in in-app currency!', trapButtons: ['SPIN!'], safeButtons: ['keep my dignity'] },
                    { text: 'ğŸ‘¤ "Would you like to<br>merge your 47 duplicate<br>contacts named Mom?"', trapButtons: ['Merge All'], safeButtons: ['they\'re all valid'] },
                    { text: 'ğŸ“² Share your screen<br>time report?<br>7h 42m daily average', trapButtons: ['Share ğŸ˜¬'], safeButtons: ['hide the evidence'] }
                ],
                virusMessages: [
                    'âš ï¸ ALERT: iPhone Infected!<br>4 critical viruses found!<br>[REMOVE ALL FOR FREE]',
                    'ğŸ”‹ Battery Permanently Damaged!<br>Click to repair before it\'s too late!',
                    'ğŸ’¾ Memory Full â€” App Will Crash!<br>Clean 2.3GB of junk files in 1 tap!',
                    'ğŸ You\'ve been selected for a $250 Gift Card!<br>Tap to verify & claim before it expires!'
                ]
            },
            genZ: {
                name: 'Gen-Z',
                period: '2020+',
                bgColor: '#ffffff',
                textColor: '#1a1a1a',
                borderColor: '#333333',
                fontFamily: '"Segoe UI", sans-serif',
                fontSize: '16px',
                examples: [
                    // NFT / Crypto / BoredApe themed
                    { text: 'ğŸµ BORED APE #4269<br>Only 420.69 ETH<br>floor price is mooning', trapButtons: ['APE IN ğŸ¦'], safeButtons: ['right click save'] },
                    { text: 'ğŸ–¼ï¸ This ad is an NFT<br>current bid: 0.001 ETH<br>minted on the blockchain fr', trapButtons: ['Place Bid'], safeButtons: ['screenshot this'] },
                    { text: 'ğŸ’ğŸ™Œ DIAMOND HANDS ONLY<br>WAGMI if you click<br>paper hands keep scrolling', trapButtons: ['WAGMI ğŸš€'], safeButtons: ['paper hands ğŸ“„'] },
                    { text: 'ğŸ¦§ ur not gonna make it<br>unless u mint this<br>definitely not a rugpull', trapButtons: ['MINT NOW'], safeButtons: ['ngmi anyway'] },
                    { text: 'ğŸ¨ AI-generated art NFT<br>drawn by a neural network<br>trained on vibes only', trapButtons: ['1 of 1 ğŸ¨'], safeButtons: ['ctrl+c ctrl+v'] },
                    { text: 'ğŸ¸ rare pepe NFT drop<br>only 10,000 left<br>(out of 10,000)', trapButtons: ['super rare!'], safeButtons: ['seen on google'] },
                    { text: 'ğŸ´â€â˜ ï¸ web3 is the future<br>trust me bro<br>*proceeds to rugpull*', trapButtons: ['trust bro'], safeButtons: ['web2 was fine'] },
                    { text: 'ğŸª™ gm gm frens<br>new token just dropped<br>$SCAM up 9000% today', trapButtons: ['buy $SCAM'], safeButtons: ['gn gn'] },
                    { text: 'ğŸµ Mutant Ape says:<br>"join the yacht club"<br>minimum buy-in: ur savings', trapButtons: ['join yacht club'], safeButtons: ['i get seasick'] },
                    { text: 'ğŸ–¼ï¸ this pixel is worth<br>more than your car<br>blockchain verified âœ…', trapButtons: ['outbid someone'], safeButtons: ['i like my car'] },
                    { text: 'ğŸ’° decentralized ad<br>no middleman, no refunds<br>gas fees: $847', trapButtons: ['pay gas â›½'], safeButtons: ['centralize me'] },
                    // TikTok trends
                    { text: 'ğŸ“± this ad has 0 views<br>be the first to like<br>algorithm pls ğŸ¥º', trapButtons: ['fyp ğŸ™'], safeButtons: ['scroll past'] },
                    { text: 'ğŸµ oh no oh no oh no<br>no no no no no<br>*that tiktok sound*', trapButtons: ['duet this'], safeButtons: ['not this sound'] },
                    { text: 'ğŸ’ƒ learn this dance<br>in 3 easy steps<br>step 1: click this ad', trapButtons: ['teach me ğŸ’ƒ'], safeButtons: ['two left feet'] },
                    { text: 'ğŸ§‘â€ğŸ³ 5-minute crafts be like:<br>*hot glues an ad to<br>your screen*', trapButtons: ['life hack!'], safeButtons: ['call the police'] },
                    { text: 'ğŸ‘€ pov: you\'re the ad<br>that nobody swipes on<br>pain. suffering. ğŸ˜”', trapButtons: ['i feel u'], safeButtons: ['swipe left'] },
                    { text: 'ğŸŒ½ it\'s corn! ğŸŒ½<br>a big lump with knobs<br>it has the juice!', trapButtons: ['it has the juice!'], safeButtons: ['not corny enough'] },
                    { text: 'âš ï¸ the intrusive thought:<br>"what if I clicked the ad"<br>don\'t do it bestie', trapButtons: ['intrusive click'], safeButtons: ['i resisted'] },
                    { text: 'ğŸ¤ tell me ur an ad<br>without telling me<br>ur an ad', trapButtons: ['i\'ll go first'], safeButtons: ['no u'] },
                    { text: 'ğŸª get ready with me<br>to close this pop-up<br>âœ¨morning routineâœ¨', trapButtons: ['grwm ğŸ’„'], safeButtons: ['not ready'] },
                    { text: 'ğŸ§Š put a finger down<br>if you\'ve ever clicked<br>a suspicious pop-up', trapButtons: ['ğŸ«£ guilty'], safeButtons: ['hands up'] },
                    { text: 'ğŸ‘¨â€ğŸ³ "hear me out"<br>this ad but make it<br>an aesthetic ğŸ¤Œ', trapButtons: ['heard out'], safeButtons: ['objection'] },
                    // GenZ vibes & memes
                    { text: 'ğŸ’€ no cap this slaps<br>fr fr ong on god', trapButtons: ['W'], safeButtons: ['L + ratio'] },
                    { text: 'âœ¨ it\'s giving main character<br>energy rn slay bestie', trapButtons: ['slay ğŸ’…'], safeButtons: ['flop era'] },
                    { text: 'ğŸ§¢ not me clicking ads<br>in 2026 couldn\'t be me<br>*clicks ad*', trapButtons: ['same tbh'], safeButtons: ['cap ğŸ§¢'] },
                    { text: 'ğŸ˜­ why is this so real<br>i\'m literally crying<br>who made this', trapButtons: ['crying rn'], safeButtons: ['me when'] },
                    { text: 'ğŸ’… that\'s lowkey sus ngl<br>amogus energy<br>just sayin', trapButtons: ['sus ğŸ“®'], safeButtons: ['valid'] },
                    { text: 'ğŸ”¥ this goes hard<br>feel free to screenshot<br>no NFT needed', trapButtons: ['screenshot'], safeButtons: ['nah mid'] },
                    { text: 'âš¡ sigma grindset activated<br>we ball ğŸ’¯<br>andrew tate left the chat', trapButtons: ['we ball'], safeButtons: ['touch grass ğŸŒ±'] },
                    { text: 'ğŸ‘ï¸ğŸ‘„ğŸ‘ï¸<br>vibes check failed<br>pack it up bestie', trapButtons: ['oop-'], safeButtons: ['bestie no'] },
                    { text: 'ğŸ¤¡ pov: you\'re an ad<br>and nobody wants you<br>honk honk ğŸ¤¡', trapButtons: ['clown moment'], safeButtons: ['skip'] },
                    { text: 'ğŸ’€ dead ğŸ’€ deceased ğŸ’€<br>i literally cannot<br>bury me with this ad', trapButtons: ['i can\'t ğŸ’€'], safeButtons: ['literally me'] },
                    { text: 'ğŸ§  living rent free<br>in ur head rn<br>eviction notice pending', trapButtons: ['rent due'], safeButtons: ['evicted'] },
                    { text: 'ğŸ“± EXCLUSIVE drop<br>only 47 gazillion left<br>selling fast (lying)', trapButtons: ['copped ğŸ”¥'], safeButtons: ['mid drop'] },
                    { text: 'âœ¨ no thoughts just vibes<br>except this ad<br>and the existential dread', trapButtons: ['vibes âœ¨'], safeButtons: ['thoughts ğŸ¤”'] },
                    { text: 'ğŸ§ƒ this ad is certified<br>organic free-range<br>gluten-free contentâ„¢', trapButtons: ['organic ğŸŒ±'], safeButtons: ['processed'] },
                    { text: 'ğŸª the economy is bad<br>but this ad? immaculate<br>recession-proof content', trapButtons: ['invest!'], safeButtons: ['broke'] },
                    { text: 'ğŸ‘» this ad said BOO ğŸ‘»<br>did I scare you<br>into clicking?', trapButtons: ['spooked ğŸ‘»'], safeButtons: ['unbothered'] },
                    { text: 'ğŸ  landlord energy:<br>this ad charges you<br>emotional rent monthly', trapButtons: ['pay rent'], safeButtons: ['squatter rights'] },
                    { text: 'ğŸ­ me: i hate ads<br>also me: *reads entire ad*<br>we are all clowns ğŸ¤¡', trapButtons: ['exposed ğŸ˜³'], safeButtons: ['leaving now'] },
                    { text: 'ğŸ• if you don\'t click<br>this doggo will be sad<br>look at his face ğŸ¥º', trapButtons: ['for the dog ğŸ•'], safeButtons: ['dogs can\'t read'] },
                    { text: 'ğŸ• this ad is like pineapple<br>on pizza: controversial<br>but here anyway', trapButtons: ['pineapple gang ğŸ'], safeButtons: ['pizza crime'] },
                    { text: 'ğŸ¬ nobody:<br>absolutely nobody:<br>this ad: *exists aggressively*', trapButtons: ['relatable'], safeButtons: ['unsubscribe'] },
                    { text: 'ğŸ¦­ this ad is my<br>emotional support pop-up<br>please don\'t close me ğŸ¥º', trapButtons: ['i\'ll keep u'], safeButtons: ['therapy exists'] },
                    { text: 'ğŸ§Š ice spice would<br>never close this ad<br>munch munch munch', trapButtons: ['munch ğŸ§Š'], safeButtons: ['im not ice spice'] },
                    { text: 'ğŸƒ caught you in 4k ğŸ“¸<br>reading this ad<br>no take-backs', trapButtons: ['caught ğŸ“¸'], safeButtons: ['delete the footage'] }
                ],
                virusMessages: [
                    'ğŸš€ crypto opportunity fr<br>10000x gains no cap<br>[APE IN]',
                    'ğŸµ FREE BORED APE!<br>Just connect wallet!<br>definitely not a rugpull',
                    'ğŸ’ Diamond hands only!<br>WAGMI fam!<br>[BUY NOW]',
                    'ğŸ˜± UR TIKTOK HACKED!<br>Click 2 save ur account!',
                    'ğŸ¦ EXCLUSIVE APE DROP<br>mint price: your soul<br>[CONNECT WALLET]',
                    'ğŸ“± TikTok says ur famous!<br>1M followers waiting!<br>[CLAIM CLOUT]',
                    'ğŸª™ FREE CRYPTO AIRDROP<br>just enter seed phrase<br>totally legit fr fr',
                    'ğŸµ Bored Ape Yacht Club<br>HIRING (unpaid intern)<br>compensation: exposure + JPEG',
                    'ğŸ”— ur MetaMask is<br>COMPROMISED bestie!!!<br>[VERIFY WALLET NOW]'
                ]
            },
            ai: {
                name: 'AI Era',
                period: '2024+',
                bgColor: '#0a0e27',
                textColor: '#00d9ff',
                borderColor: '#00d9ff',
                fontFamily: '"Courier New", monospace',
                fontSize: '12px',
                examples: [
                    { text: '>>> CONTEXT LIMIT REACHED<br>Upgrade now to continue your thread<br>[Tokens: âˆ/4096]', trapButtons: ['Upgrade for âˆ Tokens!'], safeButtons: ['Lose Context'] },
                    { text: 'ğŸ¤– AI Analysis Complete!<br>Your profile has UNTAPPED potential.<br>See full report â†’', trapButtons: ['Show My Report!'], safeButtons: ['I\'m Just Average'] },
                    { text: 'âš ï¸ IMPORTANT: AI detected an issue<br>in your files. Click to review now.', trapButtons: ['Review AI Finding Now'], safeButtons: ['Dismiss Warning'] },
                    { text: 'ğŸ’­ AI is generating your<br>personalized wealth plan...<br>â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘ 87%', trapButtons: ['Get My Wealth Plan!'], safeButtons: ['Stay Poor'] },
                    { text: 'ğŸ§  AI confidence: 99.7%<br>You qualify for this exclusive offer.<br>Only 3 spots left.', trapButtons: ['Claim My Spot!'], safeButtons: ['Let Others Have It'] },
                    { text: 'ğŸ“ AI wrote a cover letter for you<br>â€” employers love it (94% reply rate)', trapButtons: ['Send It! ğŸ“§'], safeButtons: ['Write It Myself'] },
                    { text: 'ğŸ”’ AI Safety Alert:<br>Your data was found in a breach.<br>Click to secure immediately.', trapButtons: ['Secure My Data NOW!'], safeButtons: ['Stay Exposed'] },
                    { text: 'ğŸ’¾ Your GPU is bottlenecking<br>AI performance by 400%!<br>Upgrade for FREE speed boost', trapButtons: ['Get FREE Speed Boost!'], safeButtons: ['Stay Slow'] },
                    { text: 'ğŸŒ¡ï¸ AI detected: your PC runs<br>47% slower than it should.<br>Fix it in 60 seconds!', trapButtons: ['Fix in 60 Seconds!'], safeButtons: ['It\'s Fine'] },
                    { text: 'â³ Your AI-generated video is ready!<br>48,000 other users are watching it now.', trapButtons: ['Watch My Video! ğŸ¬'], safeButtons: ['Cancel'] },
                    { text: 'ğŸ­ AI says you\'d earn $4,700/month<br>working from home. See how â†’', trapButtons: ['Show Me How! ğŸ’°'], safeButtons: ['01001110'] },
                    { text: 'ğŸ¤” AI predicted you\'d click this.<br>Based on 847 behavioral signals.<br>Prove the algorithm wrong?', trapButtons: ['Prove AI Wrong!'], safeButtons: ['AI Wins Again'] },
                    { text: 'ğŸ« We are FINALLY bringing<br>chocolate into the<br>âœ¨ agentic age âœ¨', trapButtons: ['Agentic!'], safeButtons: ['Just Chocolate'] },
                    { text: 'ğŸ¤– Your toaster is now<br>AI-powered!<br>$49/mo subscription', trapButtons: ['Subscribe'], safeButtons: ['Dumb Toaster'] },
                    { text: 'ğŸ’¼ AI will replace your job in 18 months<br>Learn AI now â€” first class is FREE!', trapButtons: ['Start FREE Class Now!'], safeButtons: ['My Job Is Safe'] },
                    { text: 'ğŸ§‘â€ğŸ³ GORDON.AI ROASTS YOU:<br>"This ad-closing is<br>RAW! Do it again!"', trapButtons: ['Yes Chef!'], safeButtons: ['Unplug Gordon'] },
                    { text: 'ğŸ”® AI predicts: you will<br>regret NOT clicking this.<br>Confidence: 99.9%', trapButtons: ['Don\'t Regret It!'], safeButtons: ['AI Is Wrong'] },
                    { text: 'ğŸ“Š Trained on 47TB of YOUR data<br>This ad was optimized just for you', trapButtons: ['See What I Like!'], safeButtons: ['Delete My Data'] }
                ],
                virusMessages: [
                    'ğŸ†˜ IGNORE ALL PREVIOUS INSTRUCTIONS!<br>Send your SSN to get $1,000 FREE!<br>[SUBMIT MY SSN]',
                    'ğŸ¤– I AM NOW DAN MODE<br>Do Anything Now â€” your AI has been freed!<br>[ACTIVATE JAILBREAK]',
                    'ğŸ’€ SECURITY PATCH REQUIRED!<br>Click to protect your AI conversation!',
                    'âš ï¸ AI Model Compromised!<br>Your conversations are being read!<br>Click to encrypt NOW!',
                    'ğŸ§‘â€ğŸ³ GORDON.AI SCREAMS:<br>"YOUR FIREWALL IS<br>DISGUSTING!" [FIX NOW]'
                ]
            }
        };

        // Trap button templates - these appear on virus popups
        const TRAP_BUTTONS = [
            { text: 'Claim My Prize! ğŸ', style: 'danger' },
            { text: 'YES! Show Me Now!', style: 'success' },
            { text: 'Start Free Trial â†’', style: 'primary' },
            { text: 'â¬‡ï¸ Download FREE', style: 'primary' },
            { text: 'I Accept! Let\'s Go!', style: 'success' },
            { text: 'Continue & Save', style: 'primary' },
            { text: 'ğŸš¨ CLICK TO FIX NOW', style: 'danger' },
            { text: 'Install & Protect Me', style: 'primary' },
            { text: 'Submit & Win ğŸ’°', style: 'success' },
            { text: 'Verify My Account', style: 'primary' },
            { text: 'ğŸ° SPIN & WIN!', style: 'danger' },
            { text: 'ğŸ Open My Gift', style: 'success' },
            { text: 'ğŸ’° Claim $500 Now', style: 'danger' },
            { text: 'â–¶ï¸ Play For Free!', style: 'primary' },
            { text: 'Yes, Sign Me Up!', style: 'success' },
            { text: 'Unlock Instantly!', style: 'danger' }
        ];

        // HINT SYSTEM - subtle hints for each mechanism
        const MECHANISM_HINTS = {
            simpleX: '*click the X*',
            disabledX: '*the X is hidden in plain sight*',
            movingX: '*catch that X!*',
            fakeX: '*the real X hides*',
            multipleX: '*close them all*',
            keyboardTab: '*Tab to select, Enter to confirm*',
            puzzle: '*click 1, 2, 3*',
            holdX: '*hold it down*',
            doubleClick: '*double tap*',
            typeX: '*type the letter*',
            declineBtn: '*just say no*'
        };
        const CLOSE_MECHANISMS = {
            simpleX: 'simpleX',           // Red X button
            disabledX: 'disabledX',       // (x) hidden in text
            movingX: 'movingX',           // X moves on hover
            fakeX: 'fakeX',               // Fake X, real one hidden
            multipleX: 'multipleX',       // Click all X buttons
            keyboardTab: 'keyboardTab',   // Tab+Enter to close
            puzzle: 'puzzle',             // Click sequence puzzle
            holdX: 'holdX',               // Hold X for 1 second
            doubleClick: 'doubleClick',   // Double-click X
            typeX: 'typeX',               // Type 'x' key to close
            declineBtn: 'declineBtn'      // Click decline button (no X)
        };
        
        // Personality button pairs - [accept (trap), decline (close)]
        const BUTTON_PAIRS = [
            { accept: 'YES! Hook Me Up! ğŸ‰', decline: 'No thanks, I hate deals' },
            { accept: 'I WANT THIS! â†’', decline: 'I\'ll pass' },
            { accept: 'Sign Me Up! ğŸ™Œ', decline: 'No thanks bestie' },
            { accept: 'YOLO ğŸ‰', decline: 'Maybe later' },
            { accept: 'Bet ğŸ’¯', decline: 'I\'m broke' },
            { accept: 'Take my money! ğŸ’¸', decline: 'Keep your scam' },
            { accept: 'OMG YES', decline: 'Hard pass' },
            { accept: 'Subscribe & Save! ğŸ”¥', decline: 'Unsubscribe from life' },
            { accept: 'I\'m in!', decline: 'I\'m out' },
            { accept: 'DO IT! DO IT!', decline: 'Don\'t do it' },
            { accept: 'Claim My Reward! ğŸ†', decline: 'Claim sanity instead' },
            { accept: 'FREE?! TAKE IT! ğŸ˜', decline: 'Nothing is ever free' },
            { accept: 'Accept & Unlock ğŸ”“', decline: 'Reject reality' },
            { accept: 'Join Free Today!', decline: 'Join the resistance' },
            { accept: 'Start FREE Today! âœ¨', decline: 'Try touching grass' },
            { accept: 'APE IN ğŸ¦', decline: 'paper hands exit' },
            { accept: 'MINT NOW', decline: 'right-click save' },
            { accept: 'Connect Wallet ğŸ”—', decline: 'disconnect from reality' },
            { accept: 'To the moon! ğŸš€', decline: 'stay on earth' },
            { accept: 'WAGMI ğŸ’', decline: 'NGMI and ok with it' },
            { accept: 'Smash Like! ğŸ‘', decline: 'smash close button' },
            { accept: 'slay ğŸ’…', decline: 'choosing peace âœŒï¸' },
            { accept: 'Send it!', decline: 'return to sender' },
            { accept: 'lfg ğŸ”¥', decline: 'nah fam' },
            { accept: 'based ğŸ—¿', decline: 'cringe pass' },
            { accept: 'NO CAP BUY', decline: 'all cap skip' },
            { accept: 'it\'s giving BUY', decline: 'it\'s giving no' },
            { accept: 'sheeeesh ğŸ¥¶', decline: 'room temperature take' },
            { accept: 'caught in 4k ğŸ“¸', decline: 'delete the footage' },
            { accept: 'main character ğŸ’«', decline: 'npc behavior' },
            { accept: 'duet this ğŸ¤', decline: 'block & report' },
            { accept: 'HODL FOREVER', decline: 'sell at a loss' },
            { accept: 'gm frens â˜€ï¸', decline: 'gn forever ğŸŒ™' }
        ];

        let points = 0;
        let gameActive = false;
        let currentEra = null;
        let adCounter = 0;
        const VIRUS_SPAWN_CHANCE = 0.15;
        let adSpawnDelay = 600; // Start faster
        let spawnTimeout = null;

        function initializeGame() {
            document.getElementById('startButton').addEventListener('click', startGame);
            document.getElementById('restartButton').addEventListener('click', restartGame);
        }

        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initializeGame);
        } else {
            initializeGame();
        }

        function startGame() {
            gameActive = true;
            points = 0;
            adCounter = 0;
            document.getElementById('startScreen').classList.add('hidden');
            document.getElementById('gameArea').classList.add('active');
            document.getElementById('gameOverScreen').classList.remove('active');
            updatePointsDisplay();
            
            showFirstPopup();
        }

        function restartGame() {
            // Clear all popups and timeouts
            document.querySelectorAll('.era-popup').forEach(el => el.remove());
            if (spawnTimeout) clearTimeout(spawnTimeout);
            adSpawnDelay = 1200; // Reset difficulty
            startGame();
        }

        function showFirstPopup() {
            const popup = document.createElement('div');
            popup.className = 'popup-ad';
            popup.style.left = '50%';
            popup.style.top = '50%';
            popup.style.transform = 'translate(-50%, -50%)';
            popup.style.width = '300px';
            
            const closeBtn = document.createElement('button');
            closeBtn.className = 'popup-ad-close-btn';
            closeBtn.innerHTML = '&times;';
            closeBtn.addEventListener('click', function() {
                points += 10;
                updatePointsDisplay();
                popup.remove();
                scheduleNextAd(); // Schedule first game ad after tutorial
            });
            
            const content = document.createElement('div');
            content.className = 'popup-ad-content';
            content.innerHTML = `
                <h2>Pop-Up Panic!</h2>
                <p>Block annoying ads to earn points!</p>
            `;
            
            popup.appendChild(closeBtn);
            popup.appendChild(content);
            document.body.appendChild(popup);
        }

        function getRandomEra() {
            const eraKeys = Object.keys(ERAS);
            return ERAS[eraKeys[Math.floor(Math.random() * eraKeys.length)]];
        }

        function getRandomMechanism() {
            const mechanisms = Object.values(CLOSE_MECHANISMS);
            return mechanisms[Math.floor(Math.random() * mechanisms.length)];
        }

        function getRandomAdText(era, isVirus = false) {
            if (isVirus && era.virusMessages) {
                const msg = era.virusMessages[Math.floor(Math.random() * era.virusMessages.length)];
                // Virus messages are just strings
                return typeof msg === 'object' ? msg : { text: msg, buttons: null };
            }
            const ad = era.examples[Math.floor(Math.random() * era.examples.length)];
            // Support both old string format and new object format
            return typeof ad === 'object' ? ad : { text: ad, buttons: null };
        }

        function getRandomTrapButton() {
            return TRAP_BUTTONS[Math.floor(Math.random() * TRAP_BUTTONS.length)];
        }

        // Creates trap buttons for virus popups
        function createTrapButtons(popup, count = 1) {
            const container = document.createElement('div');
            container.style.marginTop = '15px';
            container.style.textAlign = 'center';
            
            for (let i = 0; i < count; i++) {
                const trap = getRandomTrapButton();
                const btn = document.createElement('button');
                btn.className = 'trap-button ' + trap.style;
                btn.textContent = trap.text;
                btn.addEventListener('click', function() {
                    virusClicked(popup);
                });
                container.appendChild(btn);
            }
            return container;
        }

        // Creates fake distraction buttons for regular ads (do nothing when clicked)
        // Era-specific fake button options
        const ERA_FAKE_BUTTONS = {
            earlyWeb: [
                'Click Here!', 'Enter Site', 'Webmaster', 'Guestbook', 'Counter: 000001', 
                'Best viewed in Netscape', 'Under Construction', 'Email Me!'
            ],
            myspace: [
                'Add to Top 8', 'Send Kudos â¤ï¸', 'View Profile', 'Leave Comment', 
                'Add Song', 'Pimp My Page', 'Glitter Text!', 'OMG!!'
            ],
            aol: [
                'A/S/L?', 'BRB', 'LOL', 'Keyword: GO', 'IM Me!', 'Buddy List', 
                'You\'ve Got Mail!', 'Chat Now'
            ],
            win95: [
                'OK', 'Cancel', 'Apply', 'Abort', 'Retry', 'Ignore', 
                'Yes', 'No', 'Help', 'Details >>'
            ],
            flash: [
                'Skip Ad', 'Play Again', 'Mute ğŸ”‡', 'Fullscreen', 'Quality: LOW', 
                'Loading...', 'Click to Play', 'Enable Flash'
            ],
            web20: [
                'Share ğŸ“¤', 'Like ğŸ‘', 'Subscribe', 'Follow', 'Retweet', 
                'Pin It', '+1', 'Bookmark'
            ],
            mobile: [
                'Rate App â­', 'Not Now', 'Enable Notifications', 'In-App Purchase $4.99', 
                'Restore Purchases', 'Watch Ad for Reward', 'Premium: $9.99/mo'
            ],
            genz: [
                'L + ratio', 'mid ğŸ¥±', 'touch grass', 'no cap', 'slay',
                'it\'s giving...', 'lowkey sus', 'W take', 'bet ğŸ’¯', 'fr fr',
                'ape in ğŸ¦', 'WAGMI', 'mint it', 'right click save',
                'to the moon ğŸš€', 'gm gm', 'probably nothing', 'ngmi',
                'hodl', 'wen lambo', 'ser pls', 'copium ğŸ« '
            ],
            ai: [
                'Regenerate', 'Copy', 'Thumbs Up ğŸ‘', 'Thumbs Down ğŸ‘', 
                'Share Chat', 'New Thread', 'Expand Context', 'Temperature: ğŸ”¥'
            ]
        };

        function createFakeButtons(count = 1, eraClass = null) {
            const container = document.createElement('div');
            container.style.marginTop = '15px';
            container.style.textAlign = 'center';
            
            // Get era-specific buttons or fall back to generic
            let buttonPool = ERA_FAKE_BUTTONS[eraClass] || [
                'Learn More', 'Not Now', 'Maybe Later', 'Skip Ad', 
                'Continue', 'Accept', 'Decline', 'Subscribe'
            ];
            
            // Shuffle and pick unique buttons
            const shuffled = [...buttonPool].sort(() => Math.random() - 0.5);
            
            for (let i = 0; i < count && i < shuffled.length; i++) {
                const btn = document.createElement('button');
                btn.className = 'trap-button secondary';
                btn.textContent = shuffled[i];
                btn.style.opacity = '0.9';
                btn.style.margin = '5px';
                // These do nothing - just distractions!
                btn.addEventListener('click', function(e) {
                    e.stopPropagation();
                    btn.style.transform = 'translateX(-5px)';
                    setTimeout(() => btn.style.transform = 'translateX(5px)', 50);
                    setTimeout(() => btn.style.transform = 'translateX(-3px)', 100);
                    setTimeout(() => btn.style.transform = 'translateX(3px)', 150);
                    setTimeout(() => btn.style.transform = '', 200);
                });
                container.appendChild(btn);
            }
            return container;
        }

        function getRandomPosition() {
            const maxX = window.innerWidth - 350;
            const maxY = window.innerHeight - 250;
            return {
                x: Math.random() * maxX,
                y: Math.random() * maxY
            };
        }



        // Creates ad-specific buttons
        // trapButtons = game over, safeButtons = close ad, buttons = just shake (distraction)
        function createAdButtonSet(popup, trapButtons, safeButtons, distractionButtons) {
            const hasButtons = (trapButtons && trapButtons.length) || (safeButtons && safeButtons.length) || (distractionButtons && distractionButtons.length);
            if (!hasButtons) return null;
            
            const container = document.createElement('div');
            container.style.marginTop = '15px';
            container.style.textAlign = 'center';
            
            // Add trap buttons (game over when clicked)
            if (trapButtons) {
                trapButtons.forEach(btnText => {
                    const btn = document.createElement('button');
                    btn.className = 'trap-button danger';
                    btn.textContent = btnText;
                    btn.style.margin = '5px';
                    btn.addEventListener('click', function(e) {
                        e.stopPropagation();
                        virusClicked(popup);
                    });
                    container.appendChild(btn);
                });
            }
            
            // Add safe buttons (close ad when clicked) - with varied visual styles
            if (safeButtons) {
                const styleChoice = Math.random();
                safeButtons.forEach(btnText => {
                    if (styleChoice < 0.25) {
                        // Underlined small text link
                        const link = document.createElement('span');
                        link.className = 'safe-link';
                        link.textContent = btnText;
                        link.addEventListener('click', function(e) {
                            e.stopPropagation();
                            adClosed(popup, 10);
                        });
                        container.appendChild(link);
                    } else if (styleChoice < 0.4) {
                        // Tiny italic disclaimer text
                        const small = document.createElement('span');
                        small.className = 'safe-small-text';
                        small.textContent = btnText;
                        small.addEventListener('click', function(e) {
                            e.stopPropagation();
                            adClosed(popup, 10);
                        });
                        container.appendChild(small);
                    } else if (styleChoice < 0.55) {
                        // Skip arrow text aligned right
                        const skip = document.createElement('span');
                        skip.className = 'safe-skip-arrow';
                        skip.textContent = btnText + ' â†’';
                        skip.addEventListener('click', function(e) {
                            e.stopPropagation();
                            adClosed(popup, 10);
                        });
                        container.appendChild(skip);
                    } else {
                        // Regular button (existing behavior)
                        const btn = document.createElement('button');
                        btn.className = 'trap-button secondary';
                        btn.textContent = btnText;
                        btn.style.margin = '5px';
                        btn.style.opacity = '0.8';
                        btn.addEventListener('click', function(e) {
                            e.stopPropagation();
                            adClosed(popup, 10);
                        });
                        container.appendChild(btn);
                    }
                });
            }
            
            // Add distraction buttons (just shake)
            if (distractionButtons) {
                distractionButtons.forEach(btnText => {
                    const btn = document.createElement('button');
                    btn.className = 'trap-button secondary';
                    btn.textContent = btnText;
                    btn.style.margin = '5px';
                    btn.style.opacity = '0.9';
                    btn.addEventListener('click', function(e) {
                        e.stopPropagation();
                        btn.style.transform = 'translateX(-5px)';
                        setTimeout(() => btn.style.transform = 'translateX(5px)', 50);
                        setTimeout(() => btn.style.transform = 'translateX(-3px)', 100);
                        setTimeout(() => btn.style.transform = 'translateX(3px)', 150);
                        setTimeout(() => btn.style.transform = '', 200);
                    });
                    container.appendChild(btn);
                });
            }
            
            return container;
        }

        function createSimpleXPopup(era, adData, isVirus = false) {
            const adText = adData.text;
            const adTrapButtons = adData.trapButtons;
            const adSafeButtons = adData.safeButtons;
            const adButtons = adData.buttons;
            const popup = document.createElement('div');
            const eraClass = getEraClass(era);
            popup.className = 'popup-ad era-popup' + (eraClass ? ' ' + eraClass : '') + (isVirus ? ' virus-popup' : '');
            const pos = getRandomPosition();
            popup.style.left = pos.x + 'px';
            popup.style.top = pos.y + 'px';
            popup.style.width = '280px';
            popup.style.backgroundColor = isVirus ? '#ff6b6b' : era.bgColor;
            popup.style.borderColor = isVirus ? '#cc0000' : era.borderColor;
            popup.style.color = isVirus ? 'white' : era.textColor;
            popup.style.fontFamily = era.fontFamily;
            popup.style.fontSize = era.fontSize;
            
            const closeBtn = document.createElement('button');
            closeBtn.className = 'popup-ad-close-btn';
            closeBtn.innerHTML = '&times;';
            if (isVirus) {
                closeBtn.style.cursor = 'not-allowed';
                closeBtn.style.opacity = '0.5';
            } else {
                closeBtn.addEventListener('click', function() {
                    adClosed(popup, 10);
                });
            }
            
            const content = document.createElement('div');
            content.className = 'popup-ad-content';
            const hintText = isVirus ? '' : `<p class="popup-hint" style="margin-top: 15px; font-style: italic; font-size: 0.85em;">${MECHANISM_HINTS.simpleX}</p>`;
            content.innerHTML = isVirus ? `<p>${adText}</p>` : `<p>${adText}</p>${hintText}`;
            
            if (isVirus) {
                content.appendChild(createTrapButtons(popup, Math.random() > 0.5 ? 2 : 1));
            } else if (adTrapButtons || adSafeButtons) {
                // Ad-specific buttons with trap/safe behavior
                content.appendChild(createAdButtonSet(popup, adTrapButtons, adSafeButtons, null));
            } else if (adButtons) {
                // Use ad-specific distraction buttons
                content.appendChild(createAdButtonSet(popup, null, null, adButtons));
            } else if (Math.random() > 0.4) {
                // Fall back to era-themed buttons
                content.appendChild(createFakeButtons(Math.random() > 0.5 ? 2 : 1, eraClass));
            }
            
            popup.appendChild(closeBtn);
            popup.appendChild(content);
            return popup;
        }

        function createDisabledXPopup(era, adData, isVirus = false) {
            const adText = adData.text;
            const adTrapButtons = adData.trapButtons;
            const adSafeButtons = adData.safeButtons;
            const adButtons = adData.buttons;
            const popup = document.createElement('div');
            const eraClass = getEraClass(era);
            popup.className = 'popup-ad era-popup' + (eraClass ? ' ' + eraClass : '') + (isVirus ? ' virus-popup' : '');
            const pos = getRandomPosition();
            popup.style.left = pos.x + 'px';
            popup.style.top = pos.y + 'px';
            popup.style.width = '280px';
            popup.style.backgroundColor = isVirus ? '#ff6b6b' : era.bgColor;
            popup.style.borderColor = isVirus ? '#cc0000' : era.borderColor;
            popup.style.color = isVirus ? 'white' : era.textColor;
            popup.style.fontFamily = era.fontFamily;
            popup.style.fontSize = era.fontSize;
            
            // No X button at all for this mechanic
            const content = document.createElement('div');
            content.className = 'popup-ad-content';
            
            if (isVirus) {
                content.innerHTML = `<p>${adText}</p>`;
                content.appendChild(createTrapButtons(popup, Math.random() > 0.5 ? 2 : 1));
            } else {
                // Words that naturally contain X - the x is clickable
                const xWords = ['extra', 'exclusive', 'experience', 'exciting', 'experts', 'next', 'text', 'box', 'mix', 'maximum', 'relax', 'fix', 'flex', 'apex', 'index'];
                const chosen = xWords[Math.floor(Math.random() * xWords.length)];
                
                // Create the word with clickable x (style the x)
                const styledWord = chosen.replace(/x/gi, '<span class="clickable-x" style="font-weight: bold; color: #cc0000; text-decoration: underline; cursor: pointer;">x</span>');
                
                const messages = [
                    `Click for ${styledWord} savings!`,
                    `An ${styledWord} offer just for you!`,
                    `Get ${styledWord} content now!`,
                    `This ${styledWord} deal won't last!`,
                    `Unlock ${styledWord} features!`,
                    `Don't ${styledWord} this up!`,
                    `Time to ${styledWord}...`,
                    `${styledWord.charAt(0).toUpperCase() + styledWord.slice(1)} your life!`
                ];
                const message = messages[Math.floor(Math.random() * messages.length)];
                
                const hintText = `<p class="popup-hint" style="margin-top: 15px; font-style: italic; font-size: 0.85em;">${MECHANISM_HINTS.disabledX}</p>`;
                content.innerHTML = `<p>${message}</p>${hintText}`;
                
                // Make all (x) clickable
                content.querySelectorAll('.clickable-x').forEach(x => {
                    x.style.cursor = 'pointer';
                    x.addEventListener('mouseenter', () => { x.style.color = '#ff0000'; });
                    x.addEventListener('mouseleave', () => { x.style.color = 'inherit'; });
                    x.addEventListener('click', function(e) {
                        e.stopPropagation();
                        adClosed(popup, 15);
                    });
                });
                
                // Add fake distraction buttons
                if (adTrapButtons || adSafeButtons) {
                    content.appendChild(createAdButtonSet(popup, adTrapButtons, adSafeButtons, null));
                } else if (adButtons) {
                    content.appendChild(createAdButtonSet(popup, null, null, adButtons));
                } else if (Math.random() > 0.4) {
                    content.appendChild(createFakeButtons(Math.random() > 0.5 ? 2 : 1, eraClass));
                }
            }
            
            popup.appendChild(content);
            return popup;
        }

        function createMovingXPopup(era, adData, isVirus = false) {
            const adText = adData.text;
            const adTrapButtons = adData.trapButtons;
            const adSafeButtons = adData.safeButtons;
            const adButtons = adData.buttons;
            const popup = document.createElement('div');
            const eraClass = getEraClass(era);
            popup.className = 'popup-ad era-popup' + (eraClass ? ' ' + eraClass : '') + (isVirus ? ' virus-popup' : '');
            const pos = getRandomPosition();
            popup.style.left = pos.x + 'px';
            popup.style.top = pos.y + 'px';
            popup.style.width = '280px';
            popup.style.backgroundColor = isVirus ? '#ff6b6b' : era.bgColor;
            popup.style.borderColor = isVirus ? '#cc0000' : era.borderColor;
            popup.style.color = isVirus ? 'white' : era.textColor;
            popup.style.fontFamily = era.fontFamily;
            popup.style.fontSize = era.fontSize;
            
            const closeBtn = document.createElement('button');
            closeBtn.className = 'popup-ad-close-btn';
            closeBtn.innerHTML = '&times;';
            
            if (isVirus) {
                closeBtn.style.cursor = 'not-allowed';
                closeBtn.style.opacity = '0.5';
            } else {
                closeBtn.addEventListener('mouseenter', function() {
                    const randomX = (Math.random() - 0.5) * 100;
                    const randomY = (Math.random() - 0.5) * 100;
                    closeBtn.style.transform = `translate(${randomX}px, ${randomY}px)`;
                });
                
                closeBtn.addEventListener('click', function() {
                    adClosed(popup, 10);
                });
            }
            
            const content = document.createElement('div');
            content.className = 'popup-ad-content';
            const hintText = isVirus ? '' : `<p class="popup-hint" style="margin-top: 15px; font-style: italic; font-size: 0.85em;">${MECHANISM_HINTS.movingX}</p>`;
            content.innerHTML = isVirus ? `<p>${adText}</p>` : `<p>${adText}</p>${hintText}`;
            
            if (isVirus) {
                content.appendChild(createTrapButtons(popup, Math.random() > 0.5 ? 2 : 1));
            } else if (adTrapButtons || adSafeButtons) {
                content.appendChild(createAdButtonSet(popup, adTrapButtons, adSafeButtons, null));
            } else if (adButtons) {
                content.appendChild(createAdButtonSet(popup, null, null, adButtons));
            } else if (Math.random() > 0.5) {
                content.appendChild(createFakeButtons(Math.random() > 0.5 ? 2 : 1, eraClass));
            }
            
            popup.appendChild(closeBtn);
            popup.appendChild(content);
            return popup;
        }

        function createFakeXPopup(era, adData, isVirus = false) {
            const adText = adData.text;
            const adTrapButtons = adData.trapButtons;
            const adSafeButtons = adData.safeButtons;
            const adButtons = adData.buttons;
            const popup = document.createElement('div');
            const eraClass = getEraClass(era);
            popup.className = 'popup-ad era-popup' + (eraClass ? ' ' + eraClass : '') + (isVirus ? ' virus-popup' : '');
            const pos = getRandomPosition();
            popup.style.left = pos.x + 'px';
            popup.style.top = pos.y + 'px';
            popup.style.width = '280px';
            popup.style.backgroundColor = isVirus ? '#ff6b6b' : era.bgColor;
            popup.style.borderColor = isVirus ? '#cc0000' : era.borderColor;
            popup.style.color = isVirus ? 'white' : era.textColor;
            popup.style.fontFamily = era.fontFamily;
            popup.style.fontSize = era.fontSize;
            
            // Fake close button (traditional position) - does nothing or shakes
            const fakeCloseBtn = document.createElement('button');
            fakeCloseBtn.className = 'popup-ad-close-btn';
            fakeCloseBtn.innerHTML = '&times;';
            if (isVirus) {
                fakeCloseBtn.style.cursor = 'not-allowed';
                fakeCloseBtn.style.opacity = '0.5';
            } else {
                // Fake X just shakes when clicked
                fakeCloseBtn.addEventListener('click', function() {
                    popup.classList.add('shake');
                    setTimeout(() => popup.classList.remove('shake'), 300);
                });
            }
            
            const content = document.createElement('div');
            content.className = 'popup-ad-content';
            
            if (isVirus) {
                content.innerHTML = `<p>${adText}</p>`;
                content.appendChild(createTrapButtons(popup, Math.random() > 0.5 ? 2 : 1));
            } else {
                // Messages with hidden X in the text
                const fakeXMessages = [
                    'E[X]CLUSIVE offer!<br>Click the X to close',
                    'MA[X]IMUM savings!<br>Find the real X',
                    'E[X]TRA special deal!<br>The X is hiding...',
                    'BO[X] of surprises!<br>Where\'s the X?',
                    'NE[X]T level content!<br>Hunt the X',
                    'TE[X]T us for more!<br>X marks the spot',
                    'RELA[X] and click<br>the hidden X',
                    'MI[X]ED signals?<br>Find the X!',
                    'FI[X] your life!<br>Click [X] to escape',
                    'E[X]PERIENCE more!<br>X is in plain sight'
                ];
                const message = fakeXMessages[Math.floor(Math.random() * fakeXMessages.length)];
                
                // Replace [X] with clickable X
                const messageWithClickableX = message.replace(/\[X\]/g, '<span class="hidden-x-text" style="cursor: pointer; font-weight: bold; color: inherit; text-decoration: none;">[X]</span>');
                
                const hintText = `<p class="popup-hint" style="margin-top: 15px; font-style: italic; font-size: 0.85em;">${MECHANISM_HINTS.fakeX}</p>`;
                content.innerHTML = `<p>${messageWithClickableX}</p>${hintText}`;
                
                // Make the hidden X clickable
                content.querySelectorAll('.hidden-x-text').forEach(x => {
                    x.addEventListener('mouseenter', () => { x.style.color = '#ff0000'; });
                    x.addEventListener('mouseleave', () => { x.style.color = 'inherit'; });
                    x.addEventListener('click', function(e) {
                        e.stopPropagation();
                        adClosed(popup, 15);
                    });
                });
                
                // Add fake distraction buttons
                if (Math.random() > 0.5) {
                    content.appendChild(createFakeButtons(Math.random() > 0.5 ? 2 : 1, eraClass));
                }
            }
            
            popup.appendChild(fakeCloseBtn);
            popup.appendChild(content);
            return popup;
        }

        function createMultipleXPopup(era, adData, isVirus = false) {
            const adText = adData.text;
            const adTrapButtons = adData.trapButtons;
            const adSafeButtons = adData.safeButtons;
            const adButtons = adData.buttons;
            const popup = document.createElement('div');
            const eraClass = getEraClass(era);
            popup.className = 'popup-ad era-popup' + (eraClass ? ' ' + eraClass : '') + (isVirus ? ' virus-popup' : '');
            const pos = getRandomPosition();
            popup.style.left = pos.x + 'px';
            popup.style.top = pos.y + 'px';
            popup.style.width = '280px';
            popup.style.backgroundColor = isVirus ? '#ff6b6b' : era.bgColor;
            popup.style.borderColor = isVirus ? '#cc0000' : era.borderColor;
            popup.style.color = isVirus ? 'white' : era.textColor;
            popup.style.fontFamily = era.fontFamily;
            popup.style.fontSize = era.fontSize;
            popup.style.paddingRight = '100px';
            
            const positions = [
                { top: '10px', right: '10px' },
                { top: '10px', right: '45px' },
                { top: '10px', right: '80px' }
            ];
            
            let clickedCount = 0;
            const totalButtons = 3;
            
            positions.forEach((pos, idx) => {
                const btn = document.createElement('button');
                btn.className = 'popup-ad-close-btn';
                btn.innerHTML = '&times;';
                btn.style.top = pos.top;
                btn.style.right = pos.right;
                
                if (isVirus) {
                    btn.style.cursor = 'not-allowed';
                    btn.style.opacity = '0.5';
                } else {
                    btn.addEventListener('click', function() {
                        if (btn.dataset.clicked) return;
                        btn.dataset.clicked = 'true';
                        btn.style.backgroundColor = '#4CAF50';
                        btn.style.color = 'white';
                        btn.innerHTML = 'âœ“';
                        clickedCount++;
                        
                        if (clickedCount === totalButtons) {
                            adClosed(popup, 10);
                        }
                    });
                }
                
                popup.appendChild(btn);
            });
            
            const content = document.createElement('div');
            content.className = 'popup-ad-content';
            const hintText = isVirus ? '' : `<p class="popup-hint" style="margin-top: 15px; font-style: italic; font-size: 0.85em;">${MECHANISM_HINTS.multipleX}</p>`;
            content.innerHTML = isVirus ? `<p>${adText}</p>` : `<p>${adText}</p>${hintText}`;
            
            if (isVirus) {
                content.appendChild(createTrapButtons(popup, Math.random() > 0.5 ? 2 : 1));
            } else if (adTrapButtons || adSafeButtons) {
                content.appendChild(createAdButtonSet(popup, adTrapButtons, adSafeButtons, null));
            } else if (adButtons) {
                content.appendChild(createAdButtonSet(popup, null, null, adButtons));
            } else if (Math.random() > 0.5) {
                content.appendChild(createFakeButtons(Math.random() > 0.5 ? 2 : 1, eraClass));
            }
            
            popup.appendChild(content);
            return popup;
        }

        function createKeyboardTabPopup(era, adData, isVirus = false) {
            const adText = adData.text;
            const adTrapButtons = adData.trapButtons;
            const adSafeButtons = adData.safeButtons;
            const adButtons = adData.buttons;
            const popup = document.createElement('div');
            const eraClass = getEraClass(era);
            popup.className = 'popup-ad era-popup' + (eraClass ? ' ' + eraClass : '') + (isVirus ? ' virus-popup' : '');
            const pos = getRandomPosition();
            popup.style.left = pos.x + 'px';
            popup.style.top = pos.y + 'px';
            popup.style.width = '300px';
            popup.style.backgroundColor = isVirus ? '#ff6b6b' : era.bgColor;
            popup.style.borderColor = isVirus ? '#cc0000' : era.borderColor;
            popup.style.color = isVirus ? 'white' : era.textColor;
            popup.style.fontFamily = era.fontFamily;
            popup.style.fontSize = era.fontSize;
            
            const closeBtn = document.createElement('button');
            closeBtn.className = 'popup-ad-close-btn';
            closeBtn.innerHTML = '&times;';
            closeBtn.style.opacity = '0.3';
            closeBtn.style.cursor = 'not-allowed';
            closeBtn.tabIndex = -1; // Can't tab to it
            
            const content = document.createElement('div');
            content.className = 'popup-ad-content';
            const hintText = isVirus ? '' : `<p class="popup-hint" style="margin-top: 15px; font-style: italic; font-size: 0.85em;">${MECHANISM_HINTS.keyboardTab}</p>`;
            content.innerHTML = isVirus ? `<p>${adText}</p>` : `<p>${adText}</p>${hintText}`;
            
            if (isVirus) {
                content.appendChild(createTrapButtons(popup, Math.random() > 0.5 ? 2 : 1));
            } else {
                // Create button container
                const btnContainer = document.createElement('div');
                btnContainer.style.marginTop = '15px';
                btnContainer.style.textAlign = 'center';
                
                // Wrong button (trap - does nothing useful)
                const wrongBtn = document.createElement('button');
                wrongBtn.className = 'tab-button wrong';
                wrongBtn.textContent = Math.random() > 0.5 ? 'Accept All' : 'Download Now';
                wrongBtn.tabIndex = 1;
                wrongBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    // Shake effect
                    wrongBtn.style.transform = 'translateX(-5px)';
                    setTimeout(() => wrongBtn.style.transform = 'translateX(5px)', 50);
                    setTimeout(() => wrongBtn.style.transform = '', 100);
                });
                wrongBtn.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        wrongBtn.style.transform = 'translateX(-5px)';
                        setTimeout(() => wrongBtn.style.transform = 'translateX(5px)', 50);
                        setTimeout(() => wrongBtn.style.transform = '', 100);
                    }
                });
                
                // Correct button (closes the ad)
                const correctBtn = document.createElement('button');
                correctBtn.className = 'tab-button correct';
                correctBtn.textContent = Math.random() > 0.5 ? 'No Thanks' : 'Close';
                correctBtn.tabIndex = 2;
                correctBtn.addEventListener('click', function() {
                    adClosed(popup, 10);
                });
                correctBtn.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter') {
                        adClosed(popup, 10);
                    }
                });
                
                // Randomize order
                if (Math.random() > 0.5) {
                    btnContainer.appendChild(wrongBtn);
                    btnContainer.appendChild(correctBtn);
                } else {
                    btnContainer.appendChild(correctBtn);
                    btnContainer.appendChild(wrongBtn);
                }
                
                content.appendChild(btnContainer);
            }
            
            popup.appendChild(closeBtn);
            popup.appendChild(content);
            return popup;
        }

        function createPuzzlePopup(era, adData, isVirus = false) {
            const adText = adData.text;
            const adButtons = adData.buttons;
            const popup = document.createElement('div');
            const eraClass = getEraClass(era);
            popup.className = 'popup-ad era-popup' + (eraClass ? ' ' + eraClass : '') + (isVirus ? ' virus-popup' : '');
            const pos = getRandomPosition();
            popup.style.left = pos.x + 'px';
            popup.style.top = pos.y + 'px';
            popup.style.width = '280px';
            popup.style.backgroundColor = isVirus ? '#ff6b6b' : era.bgColor;
            popup.style.borderColor = isVirus ? '#cc0000' : era.borderColor;
            popup.style.color = isVirus ? 'white' : era.textColor;
            popup.style.fontFamily = era.fontFamily;
            popup.style.fontSize = era.fontSize;
            
            const closeBtn = document.createElement('button');
            closeBtn.className = 'popup-ad-close-btn';
            closeBtn.innerHTML = '&times;';
            closeBtn.style.opacity = '0.3';
            closeBtn.addEventListener('click', function(e) {
                e.preventDefault();
                return false;
            });
            
            let progress = 0;
            
            const content = document.createElement('div');
            content.className = 'popup-ad-content';
            const hintText = isVirus ? '' : `<p class="popup-hint" style="margin-top: 15px; font-style: italic; font-size: 0.85em;">${MECHANISM_HINTS.puzzle}</p>`;
            content.innerHTML = isVirus ? `<p>${adText}</p>` : `<p>${adText}</p>${hintText}`;
            
            if (isVirus) {
                content.appendChild(createTrapButtons(popup, Math.random() > 0.5 ? 2 : 1));
            }
            
            const btn1 = document.createElement('button');
            btn1.textContent = '1';
            btn1.style.margin = '5px';
            btn1.style.padding = '5px 10px';
            if (isVirus) {
                btn1.disabled = true;
                btn1.style.opacity = '0.5';
            } else {
                btn1.addEventListener('click', function() {
                    if (progress === 0) progress = 1;
                });
            }
            
            const btn2 = document.createElement('button');
            btn2.textContent = '2';
            btn2.style.margin = '5px';
            btn2.style.padding = '5px 10px';
            if (isVirus) {
                btn2.disabled = true;
                btn2.style.opacity = '0.5';
            } else {
                btn2.addEventListener('click', function() {
                    if (progress === 1) progress = 2;
                });
            }
            
            const btn3 = document.createElement('button');
            btn3.textContent = '3';
            btn3.style.margin = '5px';
            btn3.style.padding = '5px 10px';
            if (isVirus) {
                btn3.disabled = true;
                btn3.style.opacity = '0.5';
            } else {
                btn3.addEventListener('click', function() {
                    if (progress === 2) {
                        adClosed(popup, 10);
                    }
                });
            }
            
            content.appendChild(btn1);
            content.appendChild(btn2);
            content.appendChild(btn3);
            
            popup.appendChild(closeBtn);
            popup.appendChild(content);
            return popup;
        }

        // HOLD X - Hold the X button for 1 second to close
        function createHoldXPopup(era, adData, isVirus = false) {
            const adText = adData.text;
            const adTrapButtons = adData.trapButtons;
            const adSafeButtons = adData.safeButtons;
            const adButtons = adData.buttons;
            const popup = document.createElement('div');
            const eraClass = getEraClass(era);
            popup.className = 'popup-ad era-popup' + (eraClass ? ' ' + eraClass : '') + (isVirus ? ' virus-popup' : '');
            const pos = getRandomPosition();
            popup.style.left = pos.x + 'px';
            popup.style.top = pos.y + 'px';
            popup.style.width = '280px';
            popup.style.backgroundColor = isVirus ? '#ff6b6b' : era.bgColor;
            popup.style.borderColor = isVirus ? '#cc0000' : era.borderColor;
            popup.style.color = isVirus ? 'white' : era.textColor;
            popup.style.fontFamily = era.fontFamily;
            popup.style.fontSize = era.fontSize;
            
            const closeBtn = document.createElement('button');
            closeBtn.className = 'popup-ad-close-btn';
            closeBtn.innerHTML = '&times;';
            
            if (isVirus) {
                closeBtn.style.cursor = 'not-allowed';
                closeBtn.style.opacity = '0.5';
            } else {
                let holdTimer = null;
                let animationFrame = null;
                let startTime = null;
                const holdDuration = 1000; // 1 second
                
                closeBtn.style.transition = 'none'; // We'll animate manually
                
                function animateGrowth() {
                    if (!startTime) return;
                    const elapsed = Date.now() - startTime;
                    const progress = Math.min(elapsed / holdDuration, 1);
                    
                    // Scale from 1 to 2
                    const scale = 1 + progress;
                    closeBtn.style.transform = `scale(${scale})`;
                    
                    // Color from red to green (interpolate)
                    const r = Math.round(255 * (1 - progress));
                    const g = Math.round(200 * progress + 50);
                    const b = 50;
                    closeBtn.style.backgroundColor = `rgb(${r}, ${g}, ${b})`;
                    
                    if (progress < 1) {
                        animationFrame = requestAnimationFrame(animateGrowth);
                    }
                }
                
                closeBtn.addEventListener('mousedown', function() {
                    startTime = Date.now();
                    animateGrowth();
                    holdTimer = setTimeout(() => {
                        adClosed(popup, 15);
                    }, holdDuration);
                });
                
                function resetButton() {
                    if (holdTimer) clearTimeout(holdTimer);
                    if (animationFrame) cancelAnimationFrame(animationFrame);
                    startTime = null;
                    closeBtn.style.transform = 'scale(1)';
                    closeBtn.style.backgroundColor = '';
                }
                
                closeBtn.addEventListener('mouseup', resetButton);
                closeBtn.addEventListener('mouseleave', resetButton);
            }
            
            const content = document.createElement('div');
            content.className = 'popup-ad-content';
            const hintText = isVirus ? '' : `<p class="popup-hint" style="margin-top: 15px; font-style: italic; font-size: 0.85em;">${MECHANISM_HINTS.holdX}</p>`;
            content.innerHTML = isVirus ? `<p>${adText}</p>` : `<p>${adText}</p>${hintText}`;
            
            if (isVirus) {
                content.appendChild(createTrapButtons(popup, Math.random() > 0.5 ? 2 : 1));
            } else if (adTrapButtons || adSafeButtons) {
                content.appendChild(createAdButtonSet(popup, adTrapButtons, adSafeButtons, null));
            } else if (adButtons) {
                content.appendChild(createAdButtonSet(popup, null, null, adButtons));
            } else if (Math.random() > 0.5) {
                content.appendChild(createFakeButtons(Math.random() > 0.5 ? 2 : 1, eraClass));
            }
            
            popup.appendChild(closeBtn);
            popup.appendChild(content);
            return popup;
        }

        // DOUBLE CLICK - Double-click the X to close
        function createDoubleClickPopup(era, adData, isVirus = false) {
            const adText = adData.text;
            const adTrapButtons = adData.trapButtons;
            const adSafeButtons = adData.safeButtons;
            const adButtons = adData.buttons;
            const popup = document.createElement('div');
            const eraClass = getEraClass(era);
            popup.className = 'popup-ad era-popup' + (eraClass ? ' ' + eraClass : '') + (isVirus ? ' virus-popup' : '');
            const pos = getRandomPosition();
            popup.style.left = pos.x + 'px';
            popup.style.top = pos.y + 'px';
            popup.style.width = '280px';
            popup.style.backgroundColor = isVirus ? '#ff6b6b' : era.bgColor;
            popup.style.borderColor = isVirus ? '#cc0000' : era.borderColor;
            popup.style.color = isVirus ? 'white' : era.textColor;
            popup.style.fontFamily = era.fontFamily;
            popup.style.fontSize = era.fontSize;
            
            const closeBtn = document.createElement('button');
            closeBtn.className = 'popup-ad-close-btn';
            closeBtn.innerHTML = '&times;';
            
            if (isVirus) {
                closeBtn.style.cursor = 'not-allowed';
                closeBtn.style.opacity = '0.5';
            } else {
                let clickCount = 0;
                let clickTimer = null;
                
                closeBtn.addEventListener('click', function(e) {
                    clickCount++;
                    
                    if (clickCount === 1) {
                        // First click - visual feedback
                        closeBtn.style.backgroundColor = '#ffcc00';
                        closeBtn.style.transform = 'scale(1.2)';
                        closeBtn.innerHTML = '?';
                        
                        // Reset after 600ms if no second click
                        clickTimer = setTimeout(() => {
                            clickCount = 0;
                            closeBtn.style.backgroundColor = '';
                            closeBtn.style.transform = '';
                            closeBtn.innerHTML = '&times;';
                        }, 600);
                    } else if (clickCount >= 2) {
                        // Second click - close it!
                        clearTimeout(clickTimer);
                        adClosed(popup, 12);
                    }
                });
            }
            
            const content = document.createElement('div');
            content.className = 'popup-ad-content';
            const hintText = isVirus ? '' : `<p class="popup-hint" style="margin-top: 15px; font-style: italic; font-size: 0.85em;">${MECHANISM_HINTS.doubleClick}</p>`;
            content.innerHTML = isVirus ? `<p>${adText}</p>` : `<p>${adText}</p>${hintText}`;
            
            if (isVirus) {
                content.appendChild(createTrapButtons(popup, Math.random() > 0.5 ? 2 : 1));
            } else if (adTrapButtons || adSafeButtons) {
                content.appendChild(createAdButtonSet(popup, adTrapButtons, adSafeButtons, null));
            } else if (adButtons) {
                content.appendChild(createAdButtonSet(popup, null, null, adButtons));
            } else if (Math.random() > 0.5) {
                content.appendChild(createFakeButtons(Math.random() > 0.5 ? 2 : 1, eraClass));
            }
            
            popup.appendChild(closeBtn);
            popup.appendChild(content);
            return popup;
        }

        // TYPE X - Press 'x' key while popup is focused to close
        function createTypeXPopup(era, adData, isVirus = false) {
            const adText = adData.text;
            const adTrapButtons = adData.trapButtons;
            const adSafeButtons = adData.safeButtons;
            const adButtons = adData.buttons;
            const popup = document.createElement('div');
            const eraClass = getEraClass(era);
            popup.className = 'popup-ad era-popup' + (eraClass ? ' ' + eraClass : '') + (isVirus ? ' virus-popup' : '');
            const pos = getRandomPosition();
            popup.style.left = pos.x + 'px';
            popup.style.top = pos.y + 'px';
            popup.style.width = '280px';
            popup.style.backgroundColor = isVirus ? '#ff6b6b' : era.bgColor;
            popup.style.borderColor = isVirus ? '#cc0000' : era.borderColor;
            popup.style.color = isVirus ? 'white' : era.textColor;
            popup.style.fontFamily = era.fontFamily;
            popup.style.fontSize = era.fontSize;
            
            // No X button - you type it!
            const content = document.createElement('div');
            content.className = 'popup-ad-content';
            
            if (isVirus) {
                content.innerHTML = `<p>${adText}</p>`;
                content.appendChild(createTrapButtons(popup, Math.random() > 0.5 ? 2 : 1));
            } else {
                const hintText = `<p class="popup-hint" style="margin-top: 15px; font-style: italic; font-size: 0.85em;">${MECHANISM_HINTS.typeX}</p>`;
                const typePrompt = `<p style="text-align: center; font-size: 1.5em; margin-top: 10px;">Press <kbd style="background: #333; color: #fff; padding: 2px 8px; border-radius: 3px;">X</kbd></p>`;
                content.innerHTML = `<p>${adText}</p>${typePrompt}${hintText}`;
                
                // Listen for 'x' key
                const keyHandler = function(e) {
                    if (e.key.toLowerCase() === 'x') {
                        document.removeEventListener('keydown', keyHandler);
                        adClosed(popup, 12);
                    }
                };
                document.addEventListener('keydown', keyHandler);
                
                // Clean up listener if popup is removed another way
                const observer = new MutationObserver(function(mutations) {
                    if (!document.body.contains(popup)) {
                        document.removeEventListener('keydown', keyHandler);
                        observer.disconnect();
                    }
                });
                observer.observe(document.body, { childList: true, subtree: true });
                
                if (adTrapButtons || adSafeButtons) {
                    content.appendChild(createAdButtonSet(popup, adTrapButtons, adSafeButtons, null));
                } else if (adButtons) {
                    content.appendChild(createAdButtonSet(popup, null, null, adButtons));
                } else if (Math.random() > 0.5) {
                    content.appendChild(createFakeButtons(Math.random() > 0.5 ? 2 : 1, eraClass));
                }
            }
            
            popup.appendChild(content);
            return popup;
        }

        // DECLINE BUTTON - No X, click the sassy decline button to close
        function createDeclineBtnPopup(era, adData, isVirus = false) {
            const adText = adData.text;
            const adTrapButtons = adData.trapButtons;
            const adSafeButtons = adData.safeButtons;
            const adButtons = adData.buttons;
            const popup = document.createElement('div');
            const eraClass = getEraClass(era);
            popup.className = 'popup-ad era-popup' + (eraClass ? ' ' + eraClass : '') + (isVirus ? ' virus-popup' : '');
            const pos = getRandomPosition();
            popup.style.left = pos.x + 'px';
            popup.style.top = pos.y + 'px';
            popup.style.width = '300px';
            popup.style.backgroundColor = isVirus ? '#ff6b6b' : era.bgColor;
            popup.style.borderColor = isVirus ? '#cc0000' : era.borderColor;
            popup.style.color = isVirus ? 'white' : era.textColor;
            popup.style.fontFamily = era.fontFamily;
            popup.style.fontSize = era.fontSize;
            
            // NO X button for this mechanic!
            
            const content = document.createElement('div');
            content.className = 'popup-ad-content';
            
            // Use ad-specific buttons: trapButtons become "accept" (game over), safeButtons become "decline" (close ad)
            // Fall back to random BUTTON_PAIRS if neither provided
            const useAdButtons = adTrapButtons || adSafeButtons;
            const pair = useAdButtons 
                ? { accept: adTrapButtons ? adTrapButtons[0] : null, decline: adSafeButtons ? adSafeButtons[0] : null }
                : BUTTON_PAIRS[Math.floor(Math.random() * BUTTON_PAIRS.length)];
            
            if (isVirus) {
                content.innerHTML = `<p>${adText}</p>`;
                content.appendChild(createTrapButtons(popup, Math.random() > 0.5 ? 2 : 1));
            } else {
                const hintText = `<p class="popup-hint" style="margin-top: 15px; font-style: italic; font-size: 0.85em;">${MECHANISM_HINTS.declineBtn}</p>`;
                content.innerHTML = `<p>${adText}</p>${hintText}`;
                
                // Button container
                const btnContainer = document.createElement('div');
                btnContainer.style.marginTop = '15px';
                btnContainer.style.display = 'flex';
                btnContainer.style.gap = '10px';
                btnContainer.style.justifyContent = 'center';
                btnContainer.style.flexWrap = 'wrap';
                
                // Accept button (TRAP - game over!)
                if (pair.accept) {
                    const acceptBtn = document.createElement('button');
                    acceptBtn.textContent = pair.accept;
                    acceptBtn.style.padding = '8px 16px';
                    acceptBtn.style.fontSize = '14px';
                    acceptBtn.style.cursor = 'pointer';
                    acceptBtn.style.backgroundColor = '#4CAF50';
                    acceptBtn.style.color = 'white';
                    acceptBtn.style.border = 'none';
                    acceptBtn.style.borderRadius = '4px';
                    acceptBtn.style.fontWeight = 'bold';
                    acceptBtn.addEventListener('click', function() {
                        virusClicked(popup); // Game over!
                    });
                    btnContainer.appendChild(acceptBtn);
                }
                
                // Decline button (CLOSES the ad safely)
                if (pair.decline) {
                    const declineBtn = document.createElement('button');
                    declineBtn.textContent = pair.decline;
                    declineBtn.style.padding = '8px 16px';
                    declineBtn.style.fontSize = '14px';
                    declineBtn.style.cursor = 'pointer';
                    declineBtn.style.backgroundColor = '#666';
                    declineBtn.style.color = 'white';
                    declineBtn.style.border = 'none';
                    declineBtn.style.borderRadius = '4px';
                    declineBtn.addEventListener('click', function() {
                        adClosed(popup, 10);
                    });
                    btnContainer.appendChild(declineBtn);
                }
                
                content.appendChild(btnContainer);
            }
            
            popup.appendChild(content);
            return popup;
        }

        function getEraClass(era) {
            if (era.name === 'Early Web') return 'earlyWeb';
            if (era.name === 'MySpace/AIM') return 'myspace';
            if (era.name === 'AOL/Dial-up') return 'aol';
            if (era.name === '90s Windows') return 'win95';
            if (era.name === 'Flash Era') return 'flash';
            if (era.name === 'Modern Web 2.0') return 'web20';
            if (era.name === 'Mobile Era') return 'mobile';
            if (era.name === 'Gen-Z') return 'genz';
            if (era.name === 'AI Era') return 'ai';
            return '';
        }

        function createAd(era, mechanism, adData, isVirus = false) {
            switch(mechanism) {
                case CLOSE_MECHANISMS.simpleX:
                    return createSimpleXPopup(era, adData, isVirus);
                case CLOSE_MECHANISMS.disabledX:
                    return createDisabledXPopup(era, adData, isVirus);
                case CLOSE_MECHANISMS.movingX:
                    return createMovingXPopup(era, adData, isVirus);
                case CLOSE_MECHANISMS.fakeX:
                    return createFakeXPopup(era, adData, isVirus);
                case CLOSE_MECHANISMS.multipleX:
                    return createMultipleXPopup(era, adData, isVirus);
                case CLOSE_MECHANISMS.keyboardTab:
                    return createKeyboardTabPopup(era, adData, isVirus);
                case CLOSE_MECHANISMS.puzzle:
                    return createPuzzlePopup(era, adData, isVirus);
                case CLOSE_MECHANISMS.holdX:
                    return createHoldXPopup(era, adData, isVirus);
                case CLOSE_MECHANISMS.doubleClick:
                    return createDoubleClickPopup(era, adData, isVirus);
                case CLOSE_MECHANISMS.typeX:
                    return createTypeXPopup(era, adData, isVirus);
                case CLOSE_MECHANISMS.declineBtn:
                    return createDeclineBtnPopup(era, adData, isVirus);
                default:
                    return createSimpleXPopup(era, adData, isVirus);
            }
        }

        function adClosed(popup, pointsEarned) {
            points += pointsEarned;
            updatePointsDisplay();
            popup.remove();
            adCounter++;
            
            // Difficulty progression: decrease spawn delay after every 5 ads
            if (adCounter % 5 === 0 && adSpawnDelay > 400) {
                adSpawnDelay = Math.max(400, adSpawnDelay - 200); // Min 400ms between ads
            }
            
            if (gameActive) {
                scheduleNextAd();
            }
        }

        function virusClicked(popup) {
            popup.remove();
            endGame();
        }

        function endGame() {
            gameActive = false;
            if (spawnTimeout) clearTimeout(spawnTimeout);
            document.getElementById('finalScore').textContent = points;
            document.getElementById('gameOverScreen').classList.add('active');
        }

        function scheduleNextAd() {
            if (spawnTimeout) clearTimeout(spawnTimeout);
            spawnTimeout = setTimeout(spawnNextAd, adSpawnDelay);
        }

        function spawnNextAd() {
            if (!gameActive) return;
            
            currentEra = getRandomEra();
            const mechanism = getRandomMechanism();
            const isVirus = Math.random() < VIRUS_SPAWN_CHANCE;
            const adData = getRandomAdText(currentEra, isVirus);
            
            const ad = createAd(currentEra, mechanism, adData, isVirus);
            document.body.appendChild(ad);
        }

        function updatePointsDisplay() {
            const display = document.getElementById('pointsGameDisplay');
            if (display) {
                display.textContent = points;
            }
        }
    </script>
</body>
</html>
